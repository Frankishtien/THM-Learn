# Encryption - Crypto 101

<details>
  <summary>Key terms</summary>

* **``Plaintext``**: البيانات الأصلية قبل التشفير (زي نص أو صورة).

* **``Ciphertext``**: البيانات بعد التشفير، مش مفهومة إلا لو فكّرت التشفير.

* **``Cipher``**: الطريقة أو الخوارزمية اللي بتشفّر وتفك تشفير البيانات.

* **`Encryption`**: عملية تحويل البيانات من نص صريح لـ نص مشفر.

* **`Encoding`**: طريقة لتمثيل البيانات (زي base64)، مش تشفير لأنها سهلة العكس.

* **`Key`**: معلومة لازم تتوفر علشان تفك التشفير وترجع النص الأصلي.

* **`Passphrase`**: كلمة سر لحماية الـ key.

* **`Asymmetric encryption`**: تشفير بمفتاحين مختلفين (واحد للتشفير والتاني لفك التشفير).

* **`Symmetric encryption`**: تشفير بنفس المفتاح للتشفير والفك.

* **`Brute force`**: محاولة تخمين كلمة السر أو المفتاح عن طريق تجربة كل الاحتمالات.

* **`Cryptanalysis`**: تحليل التشفير عشان تكتشف نقاط ضعف في الخوارزمية.

* Alice و Bob: أسماء افتراضية للمتواصلين في شرح التشفير.


---

![image](https://github.com/user-attachments/assets/da8224bd-fc95-409e-a5e6-4627df4975de)


  
</details>









<details>
  <summary>Why is Encryption important?</summary>


### التشفير بيستخدم لحماية البيانات، عشان يضمن: 

  * السرية (Confidentiality): ماحدش يشوف بياناتك.
  * السلامة (Integrity): البيانات ما اتغيرتش.
  * المصداقية (Authenticity): عارف إن اللي بتتعامل معاه صح مش مخترق.

### إنت بتستخدم التشفير كل يوم بدون ما تحس، زي لما:

  * بتدخل على موقع TryHackMe، بيانات الدخول بتتبعت مشفرة عشان ما حدش يسرقها.
  
  * بتتصل بـ SSH، بيعملوا نفق مشفر يحمي الجلسة.
  
  * بتدخل على البنك بتاعك، الشهادة الرقمية بتأكدلك إن الموقع الحقيقي مش مزور.
  
  * بتنزل ملف وعايز تتأكد إنه نزل صح، بتستخدم checksum عشان تتحقق من سلامة الملف.
  
  * حتى لو مش بتتعامل مع التشفير بشكل مباشر، هو موجود وبيحمي كل حاجة رقمياً.




### لو عندك بيانات حساسة لازم تخزنها، لازم تشفرها:

  * البيانات لازم تكون مشفرة في التخزين وكمان وقت النقل.
  
  * لو بتتعامل مع بيانات بطاقات دفع، لازم تلتزم بمعايير زي PCI-DSS.
  
  * بيانات طبية وأي بيانات شخصية لازم تحميها عشان القوانين زي GDPR صارمة.

    > ماتشفرش الباسوردات! بدل كده استخدم الهاش (hashing) عشان تخزنها بأمان، إلا لو بتعمل برنامج مدير كلمات سر.
  



---

![image](https://github.com/user-attachments/assets/43a50358-f55e-4828-9b7c-57b37c8154b8)



  
</details>







<details>
  <summary>Crucial Crypto Maths</summary>


# شرح عملية المودولو (Modulo) في البرمجة والتشفير

## ما هو المودولو؟

المودولو (Modulo)، التي يُرمز لها غالبًا بعلامة النسبة المئوية (`%`)، هي ببساطة عملية حسابية لإيجاد **باقي القسمة**.

عندما نكتب:

```
X % Y
```

فإننا نسأل: "ما هو الباقي من قسمة العدد `X` على العدد `Y`؟"

---

## أمثلة للتوضيح

#### المثال الأول:


```
25 % 5 = 0
```


**الشرح:** العدد 25 قابل للقسمة على 5 بشكل كامل (لأن 5 × 5 = 25)، لذلك لا يوجد باقي من القسمة.

#### المثال الثاني:


```
23 % 6 = 5
```


**الشرح:** عند قسمة 23 على 6:
* أقرب مضاعف للعدد 6 وأقل من 23 هو 18 (أي 6 × 3).
* الباقي هو الفارق بين العدد الأصلي وأقرب مضاعف: 23 - 18 = 5.

---

## نقطة هامة: المودولو عملية غير قابلة للعكس

من أهم خصائص المودولو أنها **عملية ذات اتجاه واحد (One-Way Function)**، أي لا يمكن عكسها بسهولة لمعرفة القيمة الأصلية.

على سبيل المثال، إذا كانت لديك المعادلة التالية:


```
x % 5 = 4
```

فلا يمكنك تحديد قيمة فريدة للمتغير `x`. هناك عدد لا نهائي من القيم التي تحقق هذه المعادلة، مثل:
* 4
* 9
* 14
* 19
* 24
* ... وهكذا.

---

## أهمية المودولو في التشفير

هذه الخاصية (كونها عملية ذات اتجاه واحد) تجعل المودولو حجر أساس في العديد من خوارزميات التشفير الحديثة، وأهمها:
* **خوارزمية RSA:** تُستخدم لتشفير المفتاح العام.
* **بروتوكول ديفي وهيلمان لتبادل المفاتيح (Diffie-Hellman):** يُستخدم لإنشاء مفتاح سري مشترك.

تساعد المودولو في التعامل مع الأعداد الضخمة جدًا المستخدمة في هذه الخوارزميات وتجعل من الصعب للغاية على المهاجمين عكس العمليات الحسابية وتخمين المفاتيح السرية.

---

## أفضل لغة للتعامل مع الأعداد الكبيرة

تعتبر لغة **Python** من أفضل لغات البرمجة للتعامل مع علم التشفير والعمليات على الأعداد الكبيرة، لأنها تدعم الأعداد الصحيحة ذات الحجم غير المحدود (Arbitrary-precision integers) بشكل تلقائي، مما يسهل تطبيق خوارزميات التشفير دون القلق بشأن حدود أنواع البيانات.



---

![image](https://github.com/user-attachments/assets/6127f5f9-2112-4563-aa29-c1d4acf32fe0)




  
</details>







<details>
  <summary>Types of Encryption</summary>


# مقارنة بين أنواع التشفير: المتماثل وغير المتماثل

ينقسم عالم التشفير بشكل أساسي إلى نوعين رئيسيين، لكل منهما خصائصه وحالات استخدامه.

---

## 1. التشفير المتماثل (Symmetric Encryption)

هو النوع الذي يستخدم فيه **مفتاح واحد** لعمليتي التشفير وفك التشفير.

#### كيف يعمل؟
الفكرة بسيطة: الطرفان (المرسل والمستقبل) يجب أن يمتلكا نفس المفتاح السري.
- **للتشفير:** يتم استخدام المفتاح لتحويل النص الواضح إلى نص مشفر.
- **لفك التشفير:** يتم استخدام نفس المفتاح لتحويل النص المشفر مرة أخرى إلى نص واضح.

#### أمثلة شائعة:
- **DES (Data Encryption Standard):** يعتبر قديمًا وغير آمن للاستخدامات الحديثة.
- **AES (Advanced Encryption Standard):** هو المعيار المعتمد حاليًا والأكثر استخدامًا في العالم لتأمين البيانات.

#### مميزاته:
- **سرعة عالية:** أسرع بكثير في عمليات التشفير وفك التشفير مقارنة بالنوع غير المتماثل.
- **مفاتيح أصغر:** يستخدم مفاتيح ذات حجم صغير نسبيًا (مثل 128 أو 256 بت لخوارزمية AES).

---

## 2. التشفير غير المتماثل (Asymmetric Encryption)

يُعرف أيضًا باسم **تشفير المفتاح العام (Public-Key Cryptography)**، ويستخدم **زوجًا من المفاتيح** المترابطة رياضيًا: مفتاح عام ومفتاح خاص.

#### كيف يعمل؟
- **المفتاح العام (Public Key):** يمكن مشاركته مع أي شخص. يُستخدم لتشفير البيانات أو للتحقق من التوقيع الرقمي.
- **المفتاح الخاص (Private Key):** يجب أن يظل سريًا ولا يعرفه إلا صاحبه. يُستخدم لفك تشفير البيانات أو لإنشاء توقيع رقمي.

القاعدة الأساسية هي: **ما يتم تشفيره بأحد المفاتيح، لا يمكن فك تشفيره إلا بالمفتاح الآخر من الزوج.**

- **لتشفير رسالة:** يستخدم الشخص مفتاح المستقبِل **العام** لتشفير الرسالة. وحده المستقبِل يمكنه فك تشفيرها باستخدام مفتاحه **الخاص**.
- **للتوقيع الرقمي:** يستخدم الشخص مفتاhe **الخاص** لتوقيع البيانات. يمكن لأي شخص التحقق من صحة التوقيع باستخدام مفتاحه **العام**.

#### أمثلة شائعة:
- **RSA:** من أشهر وأقدم خوارزميات التشفير غير المتماثل.
- **التشفير باستخدام المنحنيات الإهليلجية (ECC):** يوفر نفس مستوى الأمان الذي يوفره RSA ولكن بمفاتيح أصغر حجمًا.

#### مميزاته:
- **أمان عالي لتبادل المفاتيح:** يحل مشكلة كيفية تبادل المفتاح السري بأمان (وهي مشكلة التشفير المتماثل).
- **التوقيع الرقمي:** يسمح بالتحقق من هوية المرسل وضمان عدم التلاعب بالبيانات.

#### عيوبه:
- **أبطأ** من التشفير المتماثل.
- يتطلب **مفاتيح كبيرة جدًا** (تبدأ من 2048 بت لخوارزمية RSA).

---

## جدول المقارنة

| وجه المقارنة | التشفير المتماثل (Symmetric) | التشفير غير المتماثل (Asymmetric) |
| :--- | :--- | :--- |
| **المفاتيح** | مفتاح واحد سري | زوج من المفاتيح (عام وخاص) |
| **السرعة** | سريع جدًا | بطيء نسبيًا |
| **حجم المفتاح** | صغير (128-256 بت) | كبير جدًا (2048-4096 بت) |
| **إدارة المفاتيح** | صعب (تحدي مشاركة المفتاح السري) | سهل (يمكن نشر المفتاح العام بأمان) |
| **الاستخدام الأساسي**| تشفير كميات كبيرة من البيانات | تبادل المفاتيح السرية والتوقيع الرقمي |
| **أمثلة** | AES, DES | RSA, ECC |




---

![image](https://github.com/user-attachments/assets/4e5a52f3-5088-43b1-89bb-12429869bdaa)


  
</details>








<details>
  <summary>RSA - Rivest Shamir Adleman</summary>


# شرح خوارزمية RSA: الرياضيات والهجوم في تحديات CTF

تعتبر خوارزمية RSA حجر الزاوية في عالم التشفير غير المتماثل، وفهمها ضروري لحل العديد من تحديات التشفير في مسابقات CTF.

---

## 🧠 الفكرة الرياضية وراء RSA

تعتمد قوة خوارزمية RSA على حقيقة رياضية بسيطة ولكنها قوية جدًا تتعلق بالأعداد الأولية (Prime Numbers):

- **العملية السهلة:** من السهل جدًا ضرب عددين أوليين كبيرين ببعضهما البعض.
  > مثال: `17 × 23 = 391`

- **العملية الصعبة (أساس الأمان):** من الصعب للغاية تحليل (Factorization) الناتج لمعرفة العددين الأوليين الأصليين اللذين تم ضربهما.
  > مثال: إذا أُعطيت الرقم `391`، فستحتاج إلى وقت وجهد لمعرفة أنه ناتج عن ضرب `17 × 23`. يصبح هذا الأمر شبه مستحيل حسابيًا عندما تكون الأعداد الأولية ضخمة جدًا.

هذه "الصعوبة" في التحليل هي ما يمنح RSA قوتها وأمانها.

---

## 🔑 المتغيرات والمعادلات الأساسية في RSA

لفهم كيفية عمل RSA، يجب معرفة متغيراتها الرئيسية:

- **`p` و `q`:** هما عددان أوليان كبيران يتم اختيارهما بسرية.
- **`n`:** هو ناتج ضرب `p` و `q`.


```
n = p * q
```


- **`e`:** هو الأس العام (Public Exponent)، وهو جزء من المفتاح العام.
- **`d`:** هو الأس الخاص (Private Exponent)، وهو جزء من المفتاح الخاص ويتم حسابه بناءً على `p` و `q`.
- **`m`:** هي الرسالة الأصلية (Plaintext).
- **`c`:** هي الرسالة المشفرة (Ciphertext).

#### المفاتيح:
- **المفتاح العام (Public Key):** يتكون من `(n, e)` ويُستخدم لتشفير الرسائل.
- **المفتاح الخاص (Private Key):** يتكون من `(n, d)` ويُستخدم لفك تشفير الرسائل.

---

## 🔓 الهجوم على RSA في تحديات CTF

في معظم تحديات التقاط العلم (CTF)، السيناريو الشائع هو:
1.  يتم إعطاؤك مجموعة من القيم، عادةً المفتاح العام (`n`, `e`) والرسالة المشفرة (`c`).
2.  المطلوب منك هو إيجاد الرسالة الأصلية (`m`)، والتي تكون غالبًا هي الفلاغ (Flag).

**نقطة الضعف التي يتم استغلالها هي الرقم `n`.** إذا تمكنت من تحليل `n` وإيجاد قيم `p` و `q`، يمكنك حساب قيمة المفتاح الخاص `d` بنفسك، وبالتالي فك تشفير الرسالة `c` بسهولة.

---

## 🛠️ أدوات مساعدة لحل تحديات RSA

لست بحاجة إلى إجراء كل الحسابات يدويًا. هناك أدوات قوية مصممة خصيصًا لأتمتة الهجمات الشائعة على RSA في تحديات CTF.

- **[RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool):** تعتبر الأداة الأقوى والأشمل لحل تحديات RSA. تقوم تلقائيًا بتجربة مجموعة واسعة من الهجمات بناءً على القيم المعطاة.
- **[rsatool](https://github.com/ius/rsatool):** أداة أخرى مفيدة لتوليد المفاتيح وتحليلها وإجراء عمليات حسابية بسيطة.

---

## 📌 نصيحة أخيرة وفهم أعمق

لفهم الرياضيات المعقدة وراء كيفية حساب `d` والعلاقة بين المتغيرات بعمق، يُنصح بقراءة شروحات متخصصة.

🔗 **[شرح مبسط للرياضيات في RSA](https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/)** 

  
</details>








<details>
  <summary>Establishing Keys Using Asymmetric Cryptography</summary>


# 💡 لماذا نستخدم التشفير المتماثل وغير المتماثل معًا؟ (التشفير الهجين)

 لفهم كيف تعمل بروتوكولات مثل HTTPS، يجب أن نفهم لماذا يتم دمج نوعي التشفير معًا لتحقيق أفضل توازن بين الأمان والسرعة.

---

## الفكرة باختصار: الجمع بين السرعة والأمان

هناك مشكلة في كل نوع من أنواع التشفير عند استخدامه بمفرده:

1.  **التشفير غير المتماثل (Asymmetric - مثل RSA):**
    -   **مميزاته:** آمن جدًا لتبادل المعلومات دون الحاجة لمفتاح مشترك مسبقًا.
    -   **عيوبه:** بطيء جدًا ويستهلك الكثير من الموارد الحاسوبية، مما يجعله غير عملي لتشفير كل بيانات الاتصال.

2.  **التشفير المتماثل (Symmetric - مثل AES):**
    -   **مميزاته:** سريع جدًا ومثالي لتشفير كميات كبيرة من البيانات بسرعة.
    -   **عيوبه:** يتطلب أن يكون لدى الطرفين (المرسل والمستقبل) نفس المفتاح السري، مما يطرح سؤالًا: "كيف يمكن تبادل هذا المفتاح السري بأمان في البداية؟".

**الحل هو التشفير الهجين (Hybrid Encryption):** نستخدم قوة كل نوع لسد ضعف الآخر.

---

## 🔑 كيف يتم تبادل المفتاح السري بأمان؟

نستخدم التشفير **غير المتماثل لمرة واحدة فقط** في بداية الاتصال، والهدف الوحيد هو **التفاوض على مفتاح سري مشترك بأمان**.

**خطوات العملية (كما تحدث في بروتوكول TLS/HTTPS):**

1.  **طلب الاتصال:** العميل (متصفحك) يطلب الاتصال بالخادم (الموقع الإلكتروني).
2.  **إرسال المفتاح العام:** الخادم يرسل شهادته الرقمية التي تحتوي على **مفتاحه العام**.
3.  **إنشاء وتشفير المفتاح السري:**
    -   يقوم العميل بإنشاء مفتاح سري عشوائي جديد (يُسمى *session key*).
    -   يستخدم العميل **المفتاح العام** للخادم لتشفير هذا المفتاح السري.
4.  **إرسال المفتاح المشفر:** يرسل العميل المفتاح السري المشفر إلى الخادم.
5.  **فك تشفير المفتاح السري:** الخادم هو الوحيد القادر على فك تشفير هذه الرسالة باستخدام **مفتاحه الخاص**.
6.  **بدء الاتصال الآمن:** الآن، أصبح كل من العميل والخادم يمتلكان نفس المفتاح السري (*session key*). يتم استخدام هذا المفتاح مع خوارزمية تشفير **متماثل وسريع (مثل AES)** لتشفير جميع البيانات اللاحقة بينهما.

---

## 🔒 مثال توضيحي: القفل والمفتاح

لتبسيط الفكرة، تخيل السيناريو التالي:

-   **الخادم (Server):** يمتلك قفلًا فريدًا ومفتاحه الوحيد 🔐.
-   **القفل (Padlock):** هو **المفتاح العام (Public Key)**. يمكن للخادم إرسال نسخ من هذا القفل لأي شخص.
-   **المفتاح (Key):** هو **المفتاح الخاص (Private Key)**. يحتفظ به الخادم لنفسه ولا يشاركه أبدًا.
-   **السر (Secret):** هو المفتاح السري (Symmetric Key) الذي تريد إرساله بأمان.

**الخطوات:**
1.  الخادم يرسل لك نسخة من **القفل** 🔓 (مفتاحه العام).
2.  أنت تضع **السر** 🤫 داخل صندوق 📦.
3.  تستخدم **القفل** 🔓 لإغلاق الصندوق.
4.  ترسل الصندوق المُغلق إلى الخادم. الآن، لا أحد يستطيع فتح الصندوق إلا من يملك المفتاح الأصلي.
5.  الخادم يستخدم **مفتاحه** 🔑 (مفتاحه الخاص) لفتح الصندوق والحصول على السر.

الآن أصبح لديكما نفس السر (المفتاح السري)، ويمكنكما استخدامه للتواصل بسرعة وأمان.

---

## 🌍 التطبيق في الواقع: شهادات الثقة

في العالم الحقيقي، هناك خطوة إضافية حاسمة: كيف تتأكد من أنك تتحدث مع الخادم الحقيقي (مثل google.com) وليس مع شخص ينتحل هويته في المنتصف (Man-in-the-Middle)؟

هنا يأتي دور **الشهادات الرقمية (Digital Certificates)** الصادرة عن جهات موثوقة (Certificate Authorities - CAs). هذه الشهادات تؤكد أن المفتاح العام الذي استلمته ينتمي بالفعل إلى الموقع الذي تزوره، وذلك باستخدام **التوقيعات الرقمية (Digital Signatures)**.

---

## 📌 لمعرفة المزيد

لفهم أعمق لبروتوكول HTTPS وكيفية عمله بالتفصيل، يُنصح بقراءة التدوينة التالية:

🔗 **[How does HTTPS actually work?](https://robertheaton.com/2014/03/27/how-does-https-actually-work/)**
  
  
</details>









