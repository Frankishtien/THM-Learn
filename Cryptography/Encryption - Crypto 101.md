# Encryption - Crypto 101

<details>
  <summary>Key terms</summary>

* **``Plaintext``**: البيانات الأصلية قبل التشفير (زي نص أو صورة).

* **``Ciphertext``**: البيانات بعد التشفير، مش مفهومة إلا لو فكّرت التشفير.

* **``Cipher``**: الطريقة أو الخوارزمية اللي بتشفّر وتفك تشفير البيانات.

* **`Encryption`**: عملية تحويل البيانات من نص صريح لـ نص مشفر.

* **`Encoding`**: طريقة لتمثيل البيانات (زي base64)، مش تشفير لأنها سهلة العكس.

* **`Key`**: معلومة لازم تتوفر علشان تفك التشفير وترجع النص الأصلي.

* **`Passphrase`**: كلمة سر لحماية الـ key.

* **`Asymmetric encryption`**: تشفير بمفتاحين مختلفين (واحد للتشفير والتاني لفك التشفير).

* **`Symmetric encryption`**: تشفير بنفس المفتاح للتشفير والفك.

* **`Brute force`**: محاولة تخمين كلمة السر أو المفتاح عن طريق تجربة كل الاحتمالات.

* **`Cryptanalysis`**: تحليل التشفير عشان تكتشف نقاط ضعف في الخوارزمية.

* Alice و Bob: أسماء افتراضية للمتواصلين في شرح التشفير.


---

![image](https://github.com/user-attachments/assets/da8224bd-fc95-409e-a5e6-4627df4975de)


  
</details>









<details>
  <summary>Why is Encryption important?</summary>


### التشفير بيستخدم لحماية البيانات، عشان يضمن: 

  * السرية (Confidentiality): ماحدش يشوف بياناتك.
  * السلامة (Integrity): البيانات ما اتغيرتش.
  * المصداقية (Authenticity): عارف إن اللي بتتعامل معاه صح مش مخترق.

### إنت بتستخدم التشفير كل يوم بدون ما تحس، زي لما:

  * بتدخل على موقع TryHackMe، بيانات الدخول بتتبعت مشفرة عشان ما حدش يسرقها.
  
  * بتتصل بـ SSH، بيعملوا نفق مشفر يحمي الجلسة.
  
  * بتدخل على البنك بتاعك، الشهادة الرقمية بتأكدلك إن الموقع الحقيقي مش مزور.
  
  * بتنزل ملف وعايز تتأكد إنه نزل صح، بتستخدم checksum عشان تتحقق من سلامة الملف.
  
  * حتى لو مش بتتعامل مع التشفير بشكل مباشر، هو موجود وبيحمي كل حاجة رقمياً.




### لو عندك بيانات حساسة لازم تخزنها، لازم تشفرها:

  * البيانات لازم تكون مشفرة في التخزين وكمان وقت النقل.
  
  * لو بتتعامل مع بيانات بطاقات دفع، لازم تلتزم بمعايير زي PCI-DSS.
  
  * بيانات طبية وأي بيانات شخصية لازم تحميها عشان القوانين زي GDPR صارمة.

    > ماتشفرش الباسوردات! بدل كده استخدم الهاش (hashing) عشان تخزنها بأمان، إلا لو بتعمل برنامج مدير كلمات سر.
  



---

![image](https://github.com/user-attachments/assets/43a50358-f55e-4828-9b7c-57b37c8154b8)



  
</details>







<details>
  <summary>Crucial Crypto Maths</summary>


# شرح عملية المودولو (Modulo) في البرمجة والتشفير

## ما هو المودولو؟

المودولو (Modulo)، التي يُرمز لها غالبًا بعلامة النسبة المئوية (`%`)، هي ببساطة عملية حسابية لإيجاد **باقي القسمة**.

عندما نكتب:

```
X % Y
```

فإننا نسأل: "ما هو الباقي من قسمة العدد `X` على العدد `Y`؟"

---

## أمثلة للتوضيح

#### المثال الأول:


```
25 % 5 = 0
```


**الشرح:** العدد 25 قابل للقسمة على 5 بشكل كامل (لأن 5 × 5 = 25)، لذلك لا يوجد باقي من القسمة.

#### المثال الثاني:


```
23 % 6 = 5
```


**الشرح:** عند قسمة 23 على 6:
* أقرب مضاعف للعدد 6 وأقل من 23 هو 18 (أي 6 × 3).
* الباقي هو الفارق بين العدد الأصلي وأقرب مضاعف: 23 - 18 = 5.

---

## نقطة هامة: المودولو عملية غير قابلة للعكس

من أهم خصائص المودولو أنها **عملية ذات اتجاه واحد (One-Way Function)**، أي لا يمكن عكسها بسهولة لمعرفة القيمة الأصلية.

على سبيل المثال، إذا كانت لديك المعادلة التالية:


```
x % 5 = 4
```

فلا يمكنك تحديد قيمة فريدة للمتغير `x`. هناك عدد لا نهائي من القيم التي تحقق هذه المعادلة، مثل:
* 4
* 9
* 14
* 19
* 24
* ... وهكذا.

---

## أهمية المودولو في التشفير

هذه الخاصية (كونها عملية ذات اتجاه واحد) تجعل المودولو حجر أساس في العديد من خوارزميات التشفير الحديثة، وأهمها:
* **خوارزمية RSA:** تُستخدم لتشفير المفتاح العام.
* **بروتوكول ديفي وهيلمان لتبادل المفاتيح (Diffie-Hellman):** يُستخدم لإنشاء مفتاح سري مشترك.

تساعد المودولو في التعامل مع الأعداد الضخمة جدًا المستخدمة في هذه الخوارزميات وتجعل من الصعب للغاية على المهاجمين عكس العمليات الحسابية وتخمين المفاتيح السرية.

---

## أفضل لغة للتعامل مع الأعداد الكبيرة

تعتبر لغة **Python** من أفضل لغات البرمجة للتعامل مع علم التشفير والعمليات على الأعداد الكبيرة، لأنها تدعم الأعداد الصحيحة ذات الحجم غير المحدود (Arbitrary-precision integers) بشكل تلقائي، مما يسهل تطبيق خوارزميات التشفير دون القلق بشأن حدود أنواع البيانات.



---

![image](https://github.com/user-attachments/assets/6127f5f9-2112-4563-aa29-c1d4acf32fe0)




  
</details>







<details>
  <summary>Types of Encryption</summary>


# مقارنة بين أنواع التشفير: المتماثل وغير المتماثل

ينقسم عالم التشفير بشكل أساسي إلى نوعين رئيسيين، لكل منهما خصائصه وحالات استخدامه.

---

## 1. التشفير المتماثل (Symmetric Encryption)

هو النوع الذي يستخدم فيه **مفتاح واحد** لعمليتي التشفير وفك التشفير.

#### كيف يعمل؟
الفكرة بسيطة: الطرفان (المرسل والمستقبل) يجب أن يمتلكا نفس المفتاح السري.
- **للتشفير:** يتم استخدام المفتاح لتحويل النص الواضح إلى نص مشفر.
- **لفك التشفير:** يتم استخدام نفس المفتاح لتحويل النص المشفر مرة أخرى إلى نص واضح.

#### أمثلة شائعة:
- **DES (Data Encryption Standard):** يعتبر قديمًا وغير آمن للاستخدامات الحديثة.
- **AES (Advanced Encryption Standard):** هو المعيار المعتمد حاليًا والأكثر استخدامًا في العالم لتأمين البيانات.

#### مميزاته:
- **سرعة عالية:** أسرع بكثير في عمليات التشفير وفك التشفير مقارنة بالنوع غير المتماثل.
- **مفاتيح أصغر:** يستخدم مفاتيح ذات حجم صغير نسبيًا (مثل 128 أو 256 بت لخوارزمية AES).

---

## 2. التشفير غير المتماثل (Asymmetric Encryption)

يُعرف أيضًا باسم **تشفير المفتاح العام (Public-Key Cryptography)**، ويستخدم **زوجًا من المفاتيح** المترابطة رياضيًا: مفتاح عام ومفتاح خاص.

#### كيف يعمل؟
- **المفتاح العام (Public Key):** يمكن مشاركته مع أي شخص. يُستخدم لتشفير البيانات أو للتحقق من التوقيع الرقمي.
- **المفتاح الخاص (Private Key):** يجب أن يظل سريًا ولا يعرفه إلا صاحبه. يُستخدم لفك تشفير البيانات أو لإنشاء توقيع رقمي.

القاعدة الأساسية هي: **ما يتم تشفيره بأحد المفاتيح، لا يمكن فك تشفيره إلا بالمفتاح الآخر من الزوج.**

- **لتشفير رسالة:** يستخدم الشخص مفتاح المستقبِل **العام** لتشفير الرسالة. وحده المستقبِل يمكنه فك تشفيرها باستخدام مفتاحه **الخاص**.
- **للتوقيع الرقمي:** يستخدم الشخص مفتاhe **الخاص** لتوقيع البيانات. يمكن لأي شخص التحقق من صحة التوقيع باستخدام مفتاحه **العام**.

#### أمثلة شائعة:
- **RSA:** من أشهر وأقدم خوارزميات التشفير غير المتماثل.
- **التشفير باستخدام المنحنيات الإهليلجية (ECC):** يوفر نفس مستوى الأمان الذي يوفره RSA ولكن بمفاتيح أصغر حجمًا.

#### مميزاته:
- **أمان عالي لتبادل المفاتيح:** يحل مشكلة كيفية تبادل المفتاح السري بأمان (وهي مشكلة التشفير المتماثل).
- **التوقيع الرقمي:** يسمح بالتحقق من هوية المرسل وضمان عدم التلاعب بالبيانات.

#### عيوبه:
- **أبطأ** من التشفير المتماثل.
- يتطلب **مفاتيح كبيرة جدًا** (تبدأ من 2048 بت لخوارزمية RSA).

---

## جدول المقارنة

| وجه المقارنة | التشفير المتماثل (Symmetric) | التشفير غير المتماثل (Asymmetric) |
| :--- | :--- | :--- |
| **المفاتيح** | مفتاح واحد سري | زوج من المفاتيح (عام وخاص) |
| **السرعة** | سريع جدًا | بطيء نسبيًا |
| **حجم المفتاح** | صغير (128-256 بت) | كبير جدًا (2048-4096 بت) |
| **إدارة المفاتيح** | صعب (تحدي مشاركة المفتاح السري) | سهل (يمكن نشر المفتاح العام بأمان) |
| **الاستخدام الأساسي**| تشفير كميات كبيرة من البيانات | تبادل المفاتيح السرية والتوقيع الرقمي |
| **أمثلة** | AES, DES | RSA, ECC |




---

![image](https://github.com/user-attachments/assets/4e5a52f3-5088-43b1-89bb-12429869bdaa)


  
</details>








<details>
  <summary>RSA - Rivest Shamir Adleman</summary>


# شرح خوارزمية RSA: الرياضيات والهجوم في تحديات CTF

تعتبر خوارزمية RSA حجر الزاوية في عالم التشفير غير المتماثل، وفهمها ضروري لحل العديد من تحديات التشفير في مسابقات CTF.

---

## 🧠 الفكرة الرياضية وراء RSA

تعتمد قوة خوارزمية RSA على حقيقة رياضية بسيطة ولكنها قوية جدًا تتعلق بالأعداد الأولية (Prime Numbers):

- **العملية السهلة:** من السهل جدًا ضرب عددين أوليين كبيرين ببعضهما البعض.
  > مثال: `17 × 23 = 391`

- **العملية الصعبة (أساس الأمان):** من الصعب للغاية تحليل (Factorization) الناتج لمعرفة العددين الأوليين الأصليين اللذين تم ضربهما.
  > مثال: إذا أُعطيت الرقم `391`، فستحتاج إلى وقت وجهد لمعرفة أنه ناتج عن ضرب `17 × 23`. يصبح هذا الأمر شبه مستحيل حسابيًا عندما تكون الأعداد الأولية ضخمة جدًا.

هذه "الصعوبة" في التحليل هي ما يمنح RSA قوتها وأمانها.

---

## 🔑 المتغيرات والمعادلات الأساسية في RSA

لفهم كيفية عمل RSA، يجب معرفة متغيراتها الرئيسية:

- **`p` و `q`:** هما عددان أوليان كبيران يتم اختيارهما بسرية.
- **`n`:** هو ناتج ضرب `p` و `q`.


```
n = p * q
```


- **`e`:** هو الأس العام (Public Exponent)، وهو جزء من المفتاح العام.
- **`d`:** هو الأس الخاص (Private Exponent)، وهو جزء من المفتاح الخاص ويتم حسابه بناءً على `p` و `q`.
- **`m`:** هي الرسالة الأصلية (Plaintext).
- **`c`:** هي الرسالة المشفرة (Ciphertext).

#### المفاتيح:
- **المفتاح العام (Public Key):** يتكون من `(n, e)` ويُستخدم لتشفير الرسائل.
- **المفتاح الخاص (Private Key):** يتكون من `(n, d)` ويُستخدم لفك تشفير الرسائل.

---

## 🔓 الهجوم على RSA في تحديات CTF

في معظم تحديات التقاط العلم (CTF)، السيناريو الشائع هو:
1.  يتم إعطاؤك مجموعة من القيم، عادةً المفتاح العام (`n`, `e`) والرسالة المشفرة (`c`).
2.  المطلوب منك هو إيجاد الرسالة الأصلية (`m`)، والتي تكون غالبًا هي الفلاغ (Flag).

**نقطة الضعف التي يتم استغلالها هي الرقم `n`.** إذا تمكنت من تحليل `n` وإيجاد قيم `p` و `q`، يمكنك حساب قيمة المفتاح الخاص `d` بنفسك، وبالتالي فك تشفير الرسالة `c` بسهولة.

---

## 🛠️ أدوات مساعدة لحل تحديات RSA

لست بحاجة إلى إجراء كل الحسابات يدويًا. هناك أدوات قوية مصممة خصيصًا لأتمتة الهجمات الشائعة على RSA في تحديات CTF.

- **[RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool):** تعتبر الأداة الأقوى والأشمل لحل تحديات RSA. تقوم تلقائيًا بتجربة مجموعة واسعة من الهجمات بناءً على القيم المعطاة.
- **[rsatool](https://github.com/ius/rsatool):** أداة أخرى مفيدة لتوليد المفاتيح وتحليلها وإجراء عمليات حسابية بسيطة.

---

## 📌 نصيحة أخيرة وفهم أعمق

لفهم الرياضيات المعقدة وراء كيفية حساب `d` والعلاقة بين المتغيرات بعمق، يُنصح بقراءة شروحات متخصصة.

🔗 **[شرح مبسط للرياضيات في RSA](https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/)** 

  
</details>








<details>
  <summary>Establishing Keys Using Asymmetric Cryptography</summary>


# 💡 لماذا نستخدم التشفير المتماثل وغير المتماثل معًا؟ (التشفير الهجين)

 لفهم كيف تعمل بروتوكولات مثل HTTPS، يجب أن نفهم لماذا يتم دمج نوعي التشفير معًا لتحقيق أفضل توازن بين الأمان والسرعة.

---

## الفكرة باختصار: الجمع بين السرعة والأمان

هناك مشكلة في كل نوع من أنواع التشفير عند استخدامه بمفرده:

1.  **التشفير غير المتماثل (Asymmetric - مثل RSA):**
    -   **مميزاته:** آمن جدًا لتبادل المعلومات دون الحاجة لمفتاح مشترك مسبقًا.
    -   **عيوبه:** بطيء جدًا ويستهلك الكثير من الموارد الحاسوبية، مما يجعله غير عملي لتشفير كل بيانات الاتصال.

2.  **التشفير المتماثل (Symmetric - مثل AES):**
    -   **مميزاته:** سريع جدًا ومثالي لتشفير كميات كبيرة من البيانات بسرعة.
    -   **عيوبه:** يتطلب أن يكون لدى الطرفين (المرسل والمستقبل) نفس المفتاح السري، مما يطرح سؤالًا: "كيف يمكن تبادل هذا المفتاح السري بأمان في البداية؟".

**الحل هو التشفير الهجين (Hybrid Encryption):** نستخدم قوة كل نوع لسد ضعف الآخر.

---

## 🔑 كيف يتم تبادل المفتاح السري بأمان؟

نستخدم التشفير **غير المتماثل لمرة واحدة فقط** في بداية الاتصال، والهدف الوحيد هو **التفاوض على مفتاح سري مشترك بأمان**.

**خطوات العملية (كما تحدث في بروتوكول TLS/HTTPS):**

1.  **طلب الاتصال:** العميل (متصفحك) يطلب الاتصال بالخادم (الموقع الإلكتروني).
2.  **إرسال المفتاح العام:** الخادم يرسل شهادته الرقمية التي تحتوي على **مفتاحه العام**.
3.  **إنشاء وتشفير المفتاح السري:**
    -   يقوم العميل بإنشاء مفتاح سري عشوائي جديد (يُسمى *session key*).
    -   يستخدم العميل **المفتاح العام** للخادم لتشفير هذا المفتاح السري.
4.  **إرسال المفتاح المشفر:** يرسل العميل المفتاح السري المشفر إلى الخادم.
5.  **فك تشفير المفتاح السري:** الخادم هو الوحيد القادر على فك تشفير هذه الرسالة باستخدام **مفتاحه الخاص**.
6.  **بدء الاتصال الآمن:** الآن، أصبح كل من العميل والخادم يمتلكان نفس المفتاح السري (*session key*). يتم استخدام هذا المفتاح مع خوارزمية تشفير **متماثل وسريع (مثل AES)** لتشفير جميع البيانات اللاحقة بينهما.

---

## 🔒 مثال توضيحي: القفل والمفتاح

لتبسيط الفكرة، تخيل السيناريو التالي:

-   **الخادم (Server):** يمتلك قفلًا فريدًا ومفتاحه الوحيد 🔐.
-   **القفل (Padlock):** هو **المفتاح العام (Public Key)**. يمكن للخادم إرسال نسخ من هذا القفل لأي شخص.
-   **المفتاح (Key):** هو **المفتاح الخاص (Private Key)**. يحتفظ به الخادم لنفسه ولا يشاركه أبدًا.
-   **السر (Secret):** هو المفتاح السري (Symmetric Key) الذي تريد إرساله بأمان.

**الخطوات:**
1.  الخادم يرسل لك نسخة من **القفل** 🔓 (مفتاحه العام).
2.  أنت تضع **السر** 🤫 داخل صندوق 📦.
3.  تستخدم **القفل** 🔓 لإغلاق الصندوق.
4.  ترسل الصندوق المُغلق إلى الخادم. الآن، لا أحد يستطيع فتح الصندوق إلا من يملك المفتاح الأصلي.
5.  الخادم يستخدم **مفتاحه** 🔑 (مفتاحه الخاص) لفتح الصندوق والحصول على السر.

الآن أصبح لديكما نفس السر (المفتاح السري)، ويمكنكما استخدامه للتواصل بسرعة وأمان.

---

## 🌍 التطبيق في الواقع: شهادات الثقة

في العالم الحقيقي، هناك خطوة إضافية حاسمة: كيف تتأكد من أنك تتحدث مع الخادم الحقيقي (مثل google.com) وليس مع شخص ينتحل هويته في المنتصف (Man-in-the-Middle)؟

هنا يأتي دور **الشهادات الرقمية (Digital Certificates)** الصادرة عن جهات موثوقة (Certificate Authorities - CAs). هذه الشهادات تؤكد أن المفتاح العام الذي استلمته ينتمي بالفعل إلى الموقع الذي تزوره، وذلك باستخدام **التوقيعات الرقمية (Digital Signatures)**.

---

## 📌 لمعرفة المزيد

لفهم أعمق لبروتوكول HTTPS وكيفية عمله بالتفصيل، يُنصح بقراءة التدوينة التالية:

🔗 **[How does HTTPS actually work?](https://robertheaton.com/2014/03/27/how-does-https-actually-work/)**
  
  
</details>






<details>
  <summary>Digital signatures and Certificates</summary>


# التوقيع الرقمي (Digital Signature) والشهادات الرقمية (Certificates)

يعتمد بناء الثقة على الإنترنت على مفهومين أساسيين: التوقيع الرقمي والشهادات الرقمية. كلاهما يستخدم التشفير غير المتماثل، لكن لكل منهما دور مختلف.

---

## ✍️ ما هو التوقيع الرقمي (Digital Signature)؟

التوقيع الرقمي هو بمثابة بصمتك الإلكترونية. إنه يثبت شيئين رئيسيين:
1.  **الأصالة (Authenticity):** أن الرسالة أو الملف صدر بالفعل منك.
2.  **سلامة البيانات (Integrity):** أن الرسالة أو الملف لم يتم التعديل عليه بعد توقيعه.

#### كيف يعمل؟
يستخدم التوقيع الرقمي آلية التشفير غير المتماثل بشكل معكوس:
-   **لإنشاء التوقيع:** أنت تستخدم **مفتاحك الخاص (Private Key)** لتوقيع البيانات (أو بصمة البيانات "hash").
-   **للتحقق من التوقيع:** يمكن لأي شخص استخدام **مفتاحك العام (Public Key)** للتحقق من صحة التوقيع.

بما أنك الوحيد الذي يمتلك المفتاح الخاص، فهذا يضمن أنك أنت فقط من يستطيع إنشاء هذا التوقيع.

> **✅ تطبيق بسيط:**
> تخيل أنك "تُشفّر" بصمة الملف بمفتاحك الخاص. أي شخص يمتلك مفتاحك العام يمكنه "فك تشفير" هذه البصمة ومقارنتها ببصمة الملف الأصلية. إذا تطابقتا، فهذا يثبت أن الملف سليم وأنه قادم منك.

---

## 🌐 ما هي الشهادة الرقمية (Digital Certificate)؟

بينما يثبت التوقيع **هوية الرسالة**، تثبت الشهادة الرقمية **هوية الكيان** نفسه (سواء كان شخصًا أو خادمًا). وظيفتها الأساسية هي ربط مفتاح عام معين بهوية محددة.

فكر فيها كبطاقة هوية إلكترونية. الشهادة الخاصة بخادم الويب تقول: "أنا الخادم الحقيقي لموقع `example.com`، وهذا هو مفتاحي العام المعتمد".

#### كيف نثق في الشهادة؟ - سلسلة الثقة (Chain of Trust)

الثقة في الشهادات الرقمية لا تأتي من فراغ، بل من خلال تسلسل هرمي يُعرف بـ "سلسلة الثقة":
1.  **سلطة التصديق الجذرية (Root CA):** هذه هي الجهات العليا الموثوقة (مثل DigiCert, Comodo). شهاداتها تكون مثبتة مسبقًا وموثوقة تلقائيًا في نظام التشغيل أو المتصفح.
2.  **سلطة التصديق الوسيطة (Intermediate CA):** الـ Root CA لا تصدر شهادات للمواقع مباشرة، بل توقّع وتثق في جهات وسيطة.
3.  **شهادة الخادم (Server Certificate):** الجهة الوسيطة تقوم بإصدار وتوقيع شهادة الخادم النهائية لموقعك.

عندما يرى متصفحك شهادة موقع، فإنه يتتبع هذه السلسلة لأعلى حتى يصل إلى Root CA الموثوقة لديه. إذا نجح في تتبع السلسلة، فإنه يثق في الموقع ويعرض علامة القفل الآمن.

> **✅ لماذا هذا مهم؟**
> هذه السلسلة تمنع هجمات التصيد (Phishing) وانتحال الشخصية (Man-in-the-Middle). إذا حاول شخص ما إنشاء موقع مزيف باسم `example.com`، فلن يتمكن من الحصول على شهادة موثوقة له، وسيقوم متصفحك بتحذيرك على الفور.

---

## ⚡ كيف تحصل على شهادة لموقعك؟

في الماضي، كانت الشهادات الرقمية مكلفة، لكن الآن يمكنك الحصول عليها مجانًا من خلال جهات مثل **Let’s Encrypt**. هذه الخدمة جعلت من السهل على أي صاحب موقع تفعيل بروتوكول **HTTPS** وتأمين الاتصال بين موقعه والزوار.

---

## 🔑 الخلاصة في نقاط

-   **التوقيع الرقمي (Digital Signature):** يثبت أن **البيانات** لم تُحرّف وأنها قادمة من شخص معين (يتم إنشاؤه بالمفتاح الخاص).
-   **الشهادة الرقمية (Certificate):** تثبت أن **الكيان** (مثل موقع الويب) هو الكيان الحقيقي الذي يدعيه (يتم التحقق منها عبر سلسلة الثقة).

كلاهما يعتمد بشكل أساسي على التشفير غير المتماثل لبناء شبكة آمنة وموثوقة.

  
</details>







<details>
  <summary>SSH Authentication</summary>




# 🚀 دليل استخدام مفاتيح SSH: الأمان والتحكم

عندما تتصل بخادم عبر بروتوكول SSH، فإنك تحتاج إلى إثبات هويتك. هناك طريقتان رئيسيتان للقيام بذلك:

1.  **اسم المستخدم وكلمة المرور (Username & Password):** الطريقة التقليدية والأقل أمانًا.
2.  **مفاتيح SSH (SSH Keys):** الطريقة الموصى بها، وهي الأكثر أمانًا وقوة.

---

## 🔑 ما هو مفتاح SSH؟

مفتاح SSH هو زوج من المفاتيح المترابطة التي تعتمد على التشفير غير المتماثل لإثبات هويتك دون الحاجة لإرسال كلمة مرور عبر الشبكة.

-   **المفتاح العام (Public Key):**
    -   هو الجزء الذي يمكنك مشاركته بأمان.
    -   يتم وضعه على الخادم الذي تريد الوصول إليه، تحديدًا في ملف: `~/.ssh/authorized_keys`.

-   **المفتاح الخاص (Private Key):**
    -   هو الجزء السري الذي يجب أن يبقى على جهازك فقط.
    -   **يجب ألا يراه أو يصل إليه أي شخص آخر غيرك.**

#### كيف تتم عملية التحقق؟
1.  عندما تحاول الاتصال، يرى الخادم أنك تحاول استخدام مفتاح معين للولوج.
2.  يتحقق الخادم من ملف `authorized_keys` ليرى إذا كان المفتاح العام المقابل موجودًا ومسموحًا له بالدخول.
3.  إذا كان موجودًا، يرسل الخادم لك "تحديًا" (challenge) مشفرًا بمفتاحك العام.
4.  لا يمكن فك تشفير هذا التحدي إلا باستخدام مفتاحك الخاص. يقوم عميل SSH على جهازك بذلك تلقائيًا ويرسل الرد الصحيح للخادم، فيسمح لك بالدخول.

---

## 🔒 ما فائدة الـ Passphrase للمفتاح الخاص؟

عند إنشاء مفتاح SSH، لديك خيار إضافة "عبارة مرور" (Passphrase). هذه العبارة **لا تُرسَل إلى الخادم أبدًا**. وظيفتها هي:

-   **تشفير ملف المفتاح الخاص نفسه على جهازك.**
-   إذا سُرق ملف مفتاحك الخاص، فلن يتمكن السارق من استخدامه دون معرفة عبارة المرور لفك تشفيره أولاً.
-   إنها طبقة أمان إضافية وحيوية لحماية هويتك الرقمية.

---

## 🛑 أهمية حماية المفتاح الخاص

> تعامل مع مفتاحك الخاص كما تتعامل مع كلمة مرور حسابك البنكي. إذا تمكن شخص ما من الحصول على نسخة من مفتاحك الخاص (ولم يكن محميًا بعبارة مرور قوية)، فسيتمكن من الدخول إلى جميع الخوادم التي أضفت إليها مفتاحك العام، دون الحاجة إلى أي كلمة مرور أخرى.

---

## 🛠️ كيفية استخدام مفاتيح SSH (خطوات عملية)

#### 1. توليد زوج المفاتيح
افتح الطرفية (Terminal) على جهازك واكتب الأمر التالي. يُفضل دائمًا إضافة passphrase قوية عند الطلب.
```bash
ssh-keygen -t rsa -b 4096
```


#### 2. نسخ المفتاح العام إلى الخادم
أسهل طريقة للقيام بذلك هي باستخدام الأمر ``ssh-copy-id.`` سيطلب منك كلمة مرور المستخدم لمرة واحدة فقط.

```
ssh-copy-id user@server_ip
```


#### 3. الاتصال باستخدام المفتاح
الآن يمكنك الاتصال بالخادم. إذا لم يكن مفتاحك في المسار الافتراضي، يمكنك تحديده باستخدام الراية ``-i``.


```
ssh -i /path/to/your/private_key user@server_ip
```

ملاحظة هامة: يجب أن تكون صلاحيات (permissions) ملف المفتاح الخاص 600 (قراءة وكتابة للمالك فقط) وإلا سيرفض SSH استخدامه.

``chmod 600 /path/to/your/private_key``

---



### 🐚 كيفية استخدام مفاتيح SSH لتحسين الشل (Shell Stabilization)
في سيناريوهات اختبار الاختراق، غالبًا ما تحصل على شل غير مستقر (مثل reverse shell). إذا كان للمستخدم الذي حصلت على صلاحياته إمكانية الدخول عبر SSH، يمكنك استخدام مفاتيح SSH للحصول على شل تفاعلي كامل ومستقر.

الخطوات:

1. من جهازك، انسخ محتويات مفتاحك العام (عادةً من ملف ``~/.ssh/id_rsa.pub``).
2. على الجهاز المخترق، الصق المفتاح العام في ملف ``~/.ssh/authorized_keys`` الخاص بالمستخدم. يمكنك استخدام أمر مثل:


```
echo "ssh-rsa AAAA..." >> ~/.ssh/authorized_keys
```

3. الآن، يمكنك الاتصال مباشرة من جهازك عبر SSH والحصول على شل ممتاز (مع إكمال تلقائي، تاريخ الأوامر، وعمل Ctrl+C بشكل صحيح).



### 💡 الخلاصة
* 🔹 مفاتيح SSH أقوى وأكثر أمانًا من كلمات المرور.
* 🔹 المفتاح الخاص هو هويتك؛ يجب حمايته وعدم تسريبه أبدًا.
* 🔹 إضافة passphrase للمفتاح الخاص تزيد من أمانه بشكل كبير.
* 🔹 استخدم مفاتيح SSH لتحسين وتثبيت الشل الذي تحصل عليه أثناء اختبار الاختراق.












---

```
nano id_rsa
```

```
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,0B5AB4FEB69AFB92B2100435B42B7949

jc40IChbGadGmmQieKevqwq0DijIZc6T/vE1G65Umd9fvwTd9RDl5AckbkIhh2s/
u5OTGlJ2KBGCubrzjgw4pWVI8w53gcd+K/WUCtn3cmUQKrMou0xvf9BumjFTGR38
3c2WciVmCKW/8ET78zkBhJqiw0ZOJLsx1tZRYN9hhIlSp5zmYKl7MSP6U5dUoOX/
v7p5bJjBe0ykXu7uHhx6RUEuJv75uo7UihXCtg4jpaUl7iRR4DyFFF0DtxKXQLfs
O6vaLwEvGtIeqMnMrn6Or5Xlj+cxWdsxeF+DjenZYNPSpSir3a0DN0kMqnNWUEL/
jF3GctLlhALjRJzwUAsORnMAIgzuNbUo5xjrJf3H0mUELT27457VKkRb3XitSpRi
s3T2zofBvSjxFUtSxZ22AoGHwiyvpbAuq+J/mkFzOjW2z8c9g8Zf66/o51aNFbWl
ozQEcnlKK22lz/WTZJs1KZ7efooilM5YErtbyTlsxK5VJWIPToNELH4YExcILl/Z
Oyl3PdcgPiKUe5YLL+29CJ/7iHk1M9zxlSgSB+Ba2i0oTcabR159VhpH1DRw1JDs
nYR9gg6523lD3PEzNQtui2UT7S3uympRBetJYXD9I2ezY35zdYkaSDURFo/h8ykr
zWTiUmgoZefaHx8GriYaYqAVXTqTLMGXb0XB/qrxg62Gx86ReV/kU5WnMmjTwOIo
4k0CXJl6k2/LJ7sFmS/0sj4FDtqq50ixSoDE/zFF91Q2EA/IQNEH65fj2juBFIee
NzBT+MRDH/xv7s0WfymnUVKtLgm4vK9Or5KucVVoTJF14y/iFBtnaBw3+kHnkb1x
hy1J6lK96m9UrmxB61Oa0u0Mfe31Je4gRgoZOnBQHZvBj0I0ek3WLZTpysUEq7Ar
eilO+34ZRgFN6QUdmIw+I//88A9PW+s7GR+dAVVwectF6ZIZnRN3AGDlPwk4nKoG
LPxnWroCxpPvLEMmoUQ67xmH5Mj6EOEebSmV+vH4qpke//ys6iiWfyTqusVGfnAt
Oi4HpMVvZ4AYcPfNs02dgBFtbOJrPPu6mwbQaVeRG2wT43uHlZOvDDyynS9aOIlm
h2sKJsrdlOedl4aPlGTfbNZ0M3SPPau+XprA622s39DMQhnLvzuw/of85bkHYRvN
HpGmSxzas/JrifcDl+Xd1Y6SHbetaYcaZwUXC1hXPqypltbLmHIQ5NHqLgmJeFJb
442LBxdnHWUavqBSF2igPBAoVwp4UUcngS19F5Rs72qsoN3dHliF8Pf+rP56P3CR
Gm9CL4VbrC/SMQURSJj+RLUymS2EGlHggRG+LKpmqzCqPonNmRd6UycelADHmUTC
QG1gWghIdci0cw8QjioszmJRu0/Cem86/QPCiXRfsXYwqLD1ILp3DKFFXGOtHbey
EnL8ml0l+t/fI6ewIfbYBp6cqGMd0OgbGCUh57nvxGMmQ6wSPBv44s6EV2rgz8JH
MNBRcFvWiVjTSiMrEXQrzgXS24MCm9YxkTOS/FZebYrM7fH5wrqQxIp3O8xif5mr
GkSJcoDC2UWg2KEnAgZRXdL6CPjDSkFQoLo1/w09vCwhzQDgn3dKB0HShTTuxk6j
-----END RSA PRIVATE KEY-----
```


```
ssh2john id_rsa > rsa_hash.txt
```

```
john rsa_hash.txt --wordlist=/usr/share/wordlists/rockyou.txt
```

```
john rsa_hash.txt --show
```

![image](https://github.com/user-attachments/assets/63231a12-d6a6-4992-97a4-605f25f85f8f)

``passphrase``

```
delicious
```

![image](https://github.com/user-attachments/assets/c275f489-9bde-41e2-8ffc-9ecd263aba66)


  
</details>







<details>
   <summary>Explaining Diffie Hellman Key Exchange</summary>


# 🔑 شرح بروتوكول ديفي وهيلمان لتبادل المفاتيح (Diffie-Hellman Key Exchange)

بروتوكول ديفي وهيلمان هو أحد الحلول العبقرية لمشكلة أساسية في عالم التشفير: كيف يمكن لطرفين إنشاء مفتاح سري مشترك بينهما عبر قناة اتصال غير آمنة؟

---

## ما هو تبادل المفاتيح (Key Exchange)؟

ببساطة، هي أي طريقة تهدف إلى إنشاء أو تبادل مفتاح سري مشترك بين طرفين (لنسميهما Alice و Bob). هذا المفتاح سيُستخدم لاحقًا في التشفير المتماثل (Symmetric Encryption) لتأمين الاتصال بينهما.

> **💡 الهدف الأساسي:** ضمان عدم تمكن أي شخص يتنصت على المحادثة من معرفة هذا المفتاح المشترك.

---

## 🤔 ما هو بروتوكول Diffie-Hellman (DH)؟

هو بروتوكول (طريقة) يسمح لطرفين بإنشاء مفتاح سري مشترك **دون الحاجة لنقل المفتاح نفسه عبر الشبكة**.

بدلاً من إرسال المفتاح، يقوم كل طرف بإجراء عمليات حسابية معينة، ومن خلال تبادل نتائج هذه العمليات (وليس الأسرار نفسها)، يتمكن كلاهما من الوصول إلى نفس المفتاح السري المشترك بشكل مستقل.

---

## 👑 كيف يعمل بروتوكول Diffie-Hellman؟ (شرح مبسط)

لتبسيط الفكرة، سنتجاهل الرياضيات المعقدة (التي تعتمد على اللوغاريتمات المتقطعة) ونستخدم مثالًا تشبيهيًا:

#### 1️⃣ **الاتفاق على قيم عامة (Public Parameters)**
يتفق Alice و Bob على قيم معينة تكون معروفة للجميع، حتى للمهاجم الذي قد يتنصت. لنسمي هذه القيمة العامة `C`.

#### 2️⃣ **كل طرف يختار سرًا خاصًا**
-   Alice تختار سرًا خاصًا بها لا يعرفه أحد غيرها: `A`.
-   Bob يختار سرًا خاصًا به لا يعرفه أحد غيره: `B`.

#### 3️⃣ **كل طرف يدمج سره الخاص مع القيمة العامة**
-   Alice تحسب `AC` (دمج `A` مع `C`).
-   Bob يحسب `BC` (دمج `B` مع `C`).

#### 4️⃣ **تبادل النتائج المحسوبة**
-   Alice ترسل نتيجتها `AC` إلى Bob.
-   Bob يرسل نتيجته `BC` إلى Alice.
*(لاحظ أن الأسرار `A` و `B` لم يتم إرسالها أبدًا).*

#### 5️⃣ **كل طرف يدمج النتيجة التي استلمها مع سره الخاص**
-   Alice استلمت `BC`. تقوم بدمجها مع سرها `A` لتحصل على: `(BC) + A = ABC`.
-   Bob استلم `AC`. يقوم بدمجه مع سره `B` ليحصل على: `(AC) + B = ABC`.

> **⚡ النتيجة النهائية:**
> الآن، أصبح كل من Alice و Bob يمتلكان نفس القيمة النهائية `ABC`، والتي تمثل المفتاح السري المشترك. يمكنهما الآن استخدام هذا المفتاح لتشفير وفك تشفير رسائلهما باستخدام خوارزمية تشفير متماثل سريعة (مثل AES).

---

## ⚠️ ماذا عن المهاجم الذي يتنصت؟

المهاجم (Eve) الذي يراقب الاتصال رأى كل ما تم إرساله عبر الشبكة:
-   القيمة العامة `C`.
-   نتيجة Alice المرسلة `AC`.
-   نتيجة Bob المرسلة `BC`.

لكن بدون معرفة الأسرار الخاصة (`A` أو `B`)، من الصعب حسابيًا (شبه مستحيل) على Eve أن تستنتج المفتاح السري المشترك `ABC` من هذه المعلومات فقط، لأن العملية الرياضية المستخدمة في الواقع هي دالة ذات اتجاه واحد (صعبة العكس).

---

## 💡 لماذا يُستخدم RSA أحيانًا مع Diffie-Hellman؟

بروتوكول Diffie-Hellman يؤمّن ضد **التنصت (Eavesdropping)**، لكنه لا يؤمّن ضد هجوم **الرجل في المنتصف (Man-in-the-Middle - MITM)**. يمكن لمهاجم أن يقيم اتصال DH منفصل مع كل من Alice و Bob ويتظاهر بأنه الطرف الآخر.

لهذا السبب، غالبًا ما يتم استخدام **RSA** بجانب **DH**:
-   **Diffie-Hellman:** لإنشاء المفتاح السري المشترك بأمان.
-   **RSA (والتوقيعات الرقمية):** لإثبات هوية كل طرف للآخر والتأكد من أنهم يتحدثون مع الشخص الصحيح وليس مع مهاجم في المنتصف.

---

## 📝 ملخص سريع

-   🔹 **Diffie-Hellman** يسمح لطرفين بإنشاء مفتاح سري مشترك عبر قناة غير آمنة.
-   🔹 يعتمد على دمج كل طرف لسره الخاص مع قيم عامة، ثم تبادل النتائج للوصول إلى نفس المفتاح.
-   🔹 هو آمن ضد المتنصتين، لكنه يحتاج إلى آلية إضافية مثل **RSA والتوقيعات الرقمية** للحماية من هجمات الرجل في المنتصف (MITM).
   
  
</details>












