# DFIR: An Introduction



<details>
  <summary>The need for DFIR</summary>



# 🔍 What is DFIR?

**DFIR** هي اختصار لـ **Digital Forensics and Incident Response**، وتركز على تحليل الأدلة الرقمية والاستجابة للحوادث الأمنية.

---

## 🧠 ما هو DFIR؟

DFIR هو مجال يدمج بين:
- **التحقيق الجنائي الرقمي (Digital Forensics):** جمع وتحليل الأدلة من أجهزة الكمبيوتر والهواتف وأجهزة التخزين.
- **الاستجابة للحوادث (Incident Response):** التعامل مع الحوادث الأمنية، تحديد حجم الضرر، وإعادة النظام لحالته الأصلية.

---

## ❗ لماذا نحتاج إلى DFIR؟

DFIR يساعد فرق الأمن السيبراني في:
- 📌 كشف نشاطات المهاجم وتمييزها عن الإنذارات الكاذبة.
- 🚫 إزالة وجود المهاجم بالكامل من الشبكة.
- 🕒 تحديد مدة وحجم الاختراق.
- 🛡️ معرفة الثغرات التي سمحت بالاختراق لتفاديها مستقبلًا.
- 🧠 فهم سلوك المهاجم لاتخاذ تدابير استباقية.
- 🌐 مشاركة معلومات الهجوم مع مجتمع الأمن السيبراني.

---

## 👨‍💻 من يعمل في DFIR؟

يتطلب المجال مهارات من تخصصين:

### 1. Digital Forensics
- خبراء في تتبع الأدلة الرقمية داخل الأجهزة.
  
### 2. Incident Response
- خبراء في الأمن السيبراني يستخدمون الأدلة لتفسير الحوادث الأمنية.

> 💡 محترفو DFIR يجمعون بين كلا التخصصين، ويستخدمون الأدلة لتوجيه الاستجابة الأمنية والتحقيقات بشكل متكامل.

---





  
</details>









<details>
  <summary>Basic concepts of DFIR</summary>


# 📚 DFIR Concepts Overview

بعد التعرف على ماهية DFIR وأهميته، إليك أهم المفاهيم الأساسية المرتبطة به:

---

## 🧩 Artifacts (القطع الرقمية/الأدلة)

- **التعريف:** قطع من الأدلة الرقمية تُشير إلى نشاط حدث على النظام.
- **أمثلة:** سجل في الـ Windows Registry يوضح بقاء المهاجم.
- **أماكن جمعها:** من الملفات، الذاكرة (RAM)، أو نشاط الشبكة.
- **أنظمة مستهدفة:**
  - 🪟 **Windows:** تُستخدم غالبًا كنقاط نهاية أو خوادم مثل Active Directory.
  - 🐧 **Linux:** تُستخدم كخوادم (Web, DB, إلخ).

---

## 🛡️ Evidence Preservation (حفظ الأدلة)

- **الهدف:** منع التلاعب أو تلف الأدلة الأصلية.
- **الطريقة:**
  1. جمع الأدلة.
  2. تفعيل وضع الحماية من الكتابة (Write-protect).
  3. إنشاء **نسخة للعمل عليها** دون المساس بالأصل.
  4. إمكانية الرجوع للأصل عند فساد النسخة.

---

## 📦 Chain of Custody (سلسلة الحيازة)

- **الهدف:** ضمان أن الأدلة لم تُلمس أو تُغير من شخص غير مخوّل.
- **أهمية:** إذا تم كسر سلسلة الحيازة، قد تُصبح الأدلة غير موثوقة.
- **مثال:** لا يُسمح لأي شخص غير مختص بلمس صورة القرص الصلب (Disk Image).

---

## ⚡ Order of Volatility (ترتيب زوال البيانات)

- **المقصود:** بعض الأدلة تُفقد بسرعة (volatile)، وبعضها يدوم.
- **ترتيب الأولوية عند الجمع:**
  1. 🧠 **RAM** (تفقد عند إيقاف الجهاز)
  2. 💽 **القرص الصلب** (يبقى بعد إيقاف التشغيل)
- **القاعدة:** ابدأ بالأدلة الأكثر زوالًا ثم الأقل.

---

## 📅 Timeline Creation (إنشاء الخط الزمني)

- **الهدف:** عرض الأنشطة بترتيب زمني لفهم كيف وقع الحادث.
- **الفائدة:**
  - رؤية متكاملة من الأدلة المختلفة.
  - تحديد النقاط الحرجة في الهجوم.
  - تبسيط سرد القصة الأمنية.

---

> ✅ **ممارسة عملية**: اضغط على "View Site" لبدء تدريب على إنشاء الخط الزمني من الأدلة الرقمية.




<img width="927" height="442" alt="image" src="https://github.com/user-attachments/assets/24a01827-5074-48f9-8000-d124f16ebd1a" />




  
</details>



<details>
  <summary>DFIR Tools</summary>




# 🛠️ أهم أدوات DFIR (التحليل الجنائي الرقمي والاستجابة للحوادث)

الأدوات في هذا المجال تساعد المحققين الرقميين في تحليل الأدلة، جمعها، وإنشاء جداول زمنية دقيقة للهجمات. فيما يلي نظرة على أبرز هذه الأدوات:

---

## 🧑‍💻 Eric Zimmerman's Tools

- **نبذة**: باحث أمني قام بتطوير مجموعة أدوات قوية لتحليل نظام Windows.
- **الوظائف**:
  - تحليل الريجيستري.
  - تحليل الملفات.
  - تحليل الجداول الزمنية.
- 🧭 **للتعلم العملي**:
  - TryHackMe: [Windows Forensics 1](https://tryhackme.com/room/windowsforensics1)
  - TryHackMe: [Windows Forensics 2](https://tryhackme.com/room/windowsforensics2)

---

## ⚙️ KAPE (Kroll Artifact Parser and Extractor)

- **المطور**: Eric Zimmerman
- **الوظيفة**:
  - جمع وتحليل الأدلة تلقائيًا.
  - إنشاء timeline للهجمات بسهولة.
- 🧭 **للتعلم العملي**: TryHackMe: [KAPE Room](https://tryhackme.com/room/kape)

---

## 🧪 Autopsy

- **نبذة**: منصة مفتوحة المصدر لتحليل الأدلة الرقمية.
- **الاستخدامات**:
  - تحليل الأقراص الصلبة، الهواتف المحمولة، والأجهزة القابلة للإزالة.
  - دعم إضافات (Plugins) لتسريع استخراج البيانات.
- 🧭 **للتعلم العملي**: TryHackMe: [Autopsy Room](https://tryhackme.com/room/autopsy)

---

## 🧠 Volatility

- **الوظيفة**: تحليل ذاكرة النظام (RAM) للأنظمة Windows وLinux.
- **الاستخدام**: استخراج العمليات النشطة، الشبكات، الموديلات، وغيرها.
- 🧭 **للتعلم العملي**: TryHackMe: [Volatility Room](https://tryhackme.com/room/volatility)

---

## 🔥 Redline

- **المطور**: FireEye
- **الاستخدام**: جمع بيانات جنائية من الأنظمة وتحليلها.
- **الوظائف**:
  - جمع العمليات، الشبكات، DLLs، إلخ.
- 🧭 **للتعلم العملي**: TryHackMe: [Redline Room](https://tryhackme.com/room/redline)

---

## 🦖 Velociraptor

- **الوظيفة**: منصة متقدمة لمراقبة نقاط النهاية والاستجابة للحوادث.
- **المميزات**:
  - مفتوح المصدر.
  - قوي في تحليل النظام والملفات الحية.
- 🧭 **للتعلم العملي**: TryHackMe: [Velociraptor Room](https://tryhackme.com/room/velociraptor)

---

> 🎯 **ملاحظة**: الأدوات دي قوية جدًا، لكن الأهم هو فهم **خطوات DFIR** نفسها علشان تستخدم الأدوات بشكل صحيح.




  
</details>









<details>
  <summary>The Incident Response process</summary>


# 🚨 Incident Response في DFIR (دليل عملي وفقًا لـ SANS/NIST)

في مجال أمن المعلومات، تلعب **التحليلات الجنائية الرقمية (DFIR)** دورًا أساسيًا في دعم عمليات **الاستجابة للحوادث (Incident Response)**. تم تحديد خطوات الاستجابة من قبل منظمات مثل:

- **NIST** في دليل: SP-800-61
- **SANS** في: Incident Handler's Handbook

## 🔁 المقارنة بين SANS و NIST

| المرحلة            | SANS       | NIST                          |
|---------------------|------------|-------------------------------|
| التحضير            | Preparation| Preparation                   |
| تحديد الحادث       | Identification | Detection and Analysis   |
| الاحتواء           | Containment| Containment                   |
| الاستئصال          | Eradication| Eradication                   |
| الاستعادة          | Recovery   | Recovery                      |
| التعلم من الدرس     | Lessons Learned | Post-incident Activity     |

---

## 🔠 خطوات SANS (PICERL)



<img width="1400" height="117" alt="image" src="https://github.com/user-attachments/assets/4b5bff28-8138-40a1-8a8b-fe1a4d4e3506" />




### 🧰 1. Preparation (التحضير)

- تجهيز الفريق والأدوات والبنية التحتية للتعامل مع الحوادث.
- يشمل:
  - سياسات أمنية واضحة.
  - إجراءات استجابة محددة مسبقًا.
  - تدريب الفريق على التعامل مع الحوادث.

---

### 🔎 2. Identification (تحديد الحادث)

- التعرف على وجود حادث عبر مؤشرات (Indicators).
- التحقق من التنبيهات وتحليل الـ False Positives.
- التواصل مع أصحاب العلاقة وتوثيق الحدث.

---

### 🔒 3. Containment (الاحتواء)

- الحد من انتشار وتأثير الحادث.
- يشمل احتواء قصير المدى (مثل فصل الجهاز المتأثر) وطويل المدى (مثل تحديث الأنظمة).
- يتم الاستناد إلى التحليل الجنائي لتحديد الخطوات الأمثل.

---

### 🧹 4. Eradication (الاستئصال)

- إزالة المهاجم من الشبكة نهائيًا.
- التأكد من غلق مدخلات التهديد (مثل Backdoors أو ثغرات استُغلت).
- التحقق من عدم وجود آثار خبيثة في النظام.

---

### 🔁 5. Recovery (الاستعادة)

- إعادة الخدمات إلى وضعها الطبيعي.
- اختبار الأنظمة المتأثرة بعد التنظيف.
- مراقبة إضافية لضمان عدم حدوث اختراق جديد.

---

### 🧠 6. Lessons Learned (التعلم من الحادث)

- توثيق ما حدث، كيفية الاستجابة، وما تم اكتشافه.
- عقد اجتماع مع الفريق لمراجعة الإجراءات.
- تحديث خطط الطوارئ والبنية الأمنية لتجنب حوادث مستقبلية مماثلة.

---

> 📌 **ملحوظة**: على الرغم من أن SANS و NIST يستخدمان تسميات مختلفة، فإن الخطوات والمبادئ هي نفسها تقريبًا. استخدام اختصار **PICERL** يساعد على تذكر الترتيب بسهولة.



  
</details>



















