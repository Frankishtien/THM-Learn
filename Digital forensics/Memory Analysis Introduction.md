# Memory Analysis Introduction




<details>
  <summary>Volatile Memory</summary>


# ๐ง Volatile Memory & RAM Forensics

## ๐ ูุง ูู ุงูุฐุงูุฑุฉ ุงููุชุทุงูุฑุฉ (Volatile Memory)ุ

- ุงูุฐุงูุฑุฉ ุงููุชุทุงูุฑุฉ ุชุดูุฑ ุฅูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ุฃุซูุงุก ุชุดุบูู ุงูุฌูุงุฒุ ูุชููุฏ ุนูุฏ ุฅุบูุงูู ุฃู ุฅุนุงุฏุฉ ุชุดุบููู.
- ุฃุดูุฑ ุฃูุซูุชูุง: **ุงูู RAM (Random Access Memory)**.
- ุชุญุชูู ุนูู:
  - ูููุงุช ููุชูุญุฉ
  - ุงูุนูููุงุช ุงูุฌุงุฑูุฉ
  - ูุญุชูู ูุดูุฑ (ูุฏ ูุดูู ููุงุชูุญ ุงูุชุดููุฑ)

โ ูุฐูู ุชุนุฏ ูู ุฃููููุงุช ุงูุชุญููู ุงูุฌูุงุฆู ุงูุฑููู ูุฃููุง ุชุฒูู ุจูุฌุฑุฏ ุฅููุงู ุงูุฌูุงุฒ.

---

## ๐๏ธ Memory Hierarchy (ุชุณูุณู ุงูุฐุงูุฑุฉ)


<img width="502" height="783" alt="image" src="https://github.com/user-attachments/assets/316b47ea-f447-4c1d-ad10-2ff66a18de4a" />





| ุงููุณุชูู        | ุงูุณุฑุนุฉ | ุงูุณุนุฉ | ุฃูุซูุฉ                            |
|----------------|--------|-------|----------------------------------|
| CPU Registers  | ๐ ุนุงููุฉ | ๐ง ุตุบูุฑุฉ | ุณุฌูุงุช ุงููุนุงูุฌ                   |
| CPU Cache      | ๐ ุนุงููุฉ | ๐ง ุตุบูุฑุฉ | ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช            |
| RAM            | โ ูุชูุณุทุฉ | โ ูุชูุณุทุฉ | ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู           |
| Disk Storage   | โฌ๏ธ ุฃุจุทุฃ  | ๐ฆ ูุจูุฑุฉ | ุฃูุฑุงุต ุงูุชุฎุฒูู (HDD, SSD)        |

### ๐ก Virtual Memory (ุงูุฐุงูุฑุฉ ุงูุงูุชุฑุงุถูุฉ)

<img width="947" height="661" alt="image" src="https://github.com/user-attachments/assets/c9691a95-4254-4862-aed1-3373c810773a" />




- ูุธุงู ูุณุชุฎุฏู **ุนูุงููู ุงูุชุฑุงุถูุฉ** ูุชู ุฑุจุทูุง ุจุฑุงู ุฃู **ููู Swap** ุนูู ุงููุฑุต.
- ูุณุงุนุฏ ุนูู ุชุดุบูู ุนุฏุฏ ุฃูุจุฑ ูู ุงูุนูููุงุช ููุง ูููู ุฃู ุชุชุญููู RAM ูุญุฏูุง.

> โ๏ธ ุจุนุถ ุงูุฃุฏูุฉ ูุฏ ุชููู ูู RAM ุฃู ูู ูููุงุช Swap (ุนูู ุงููุฑุต).

---

## ๐งฌ RAM Structure (ูููููุฉ RAM)

ุชููุณู ุฅูู:

### ๐ง Kernel Space
- ููู OS ูุงูุฎุฏูุงุช ุงูููุฎูุถุฉ ุงููุณุชูู (ูุซุงู: ุงูุชุนุฑููุงุช).

### ๐ค User Space
- ููู ุนูููุฉ ูุทูููุง ุงููุณุชุฎุฏู.
- ูุญุชูู ุนูู:
  - **Stack**: ุงูุจูุงูุงุช ุงููุคูุชุฉ ูุซู ุงูุนูุงููู ูุงูููู ุงูุฑุงุฌุนุฉ.
  - **Heap**: ุงููุงุฆูุงุช ูุงูุฐุงูุฑุฉ ุงูุฏููุงููููุฉ (ูุซู ุงูููุงุชูุญ ุงููุดูุฑุฉ).
  - **Text**: ููุฏ ุงูุจุฑูุงูุฌ ุงูุชูููุฐู.
  - **Data Sections**: ูุชุบูุฑุงุช ุนุงูุฉ ูุจูุงูุงุช ุฃุฎุฑู.

> ๐ฏ ูุซุงู: ูุฏ ูุฌุฏ ููุงุชูุญ ุงูุชุดููุฑ ูู ุงูู Heapุ ุฃู ุฃูุงูุฑ Shell ูู ุงูู Stack.



<img width="1012" height="688" alt="image" src="https://github.com/user-attachments/assets/a16c4cb3-3531-40c9-90e3-4cfd292a5f69" />



---

## ๐งช ููุงุฐุง ุชุนุชุจุฑ RAM ูููุฉ ูููุญูููู ุงูุฌูุงุฆูููุ

ุชุญููู RAM ูุนุทู **ุตูุฑุฉ ูุญุธูุฉ** ููุง ูุงู ูุญุฏุซ ุนูู ุงูุฌูุงุฒุ ูุซู:

- ุงูุนูููุงุช ุงููุดุทุฉ ูุงูููุฏุงุช ุงููุญููุฉ
- ุงูุงุชุตุงูุงุช ุงูุดุจููุฉ ุงูููุชูุญุฉ
- ุงููุณุชุฎุฏููู ุงููุชุตููู ุญุงูููุง
- ูุญุชูู ูุดูุฑ ููููู ุงูุชุดููุฑ
- ููุฏ ุถุงุฑ ูุญููู ุฃู Fileless Malware

> ๐ ูุฐู ุงููุนูููุงุช **ุชุฎุชูู ุจุนุฏ ุฅููุงู ุงูุชุดุบูู**ุ ูุฐุง ูุฌุจ ุงูุชูุงุทูุง ูุจูุฑูุง ุฃุซูุงุก ุงูุชุญููู.

---

## ๐ฏ ูุชู ูุณุชุฎุฏู Memory Forensicsุ

- ุฃุซูุงุก **ุงูุงุณุชุฌุงุจุฉ ููุญูุงุฏุซ** (Incident Response).
- ูู ุญุงูุงุช:
  - ุชุญููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ
  - ุงูุชุดุงู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุบูุฑ ุงูููุชูุจุฉ ุนูู ุงููุฑุต
  - ุณุฑูุฉ ูููุงุช ุงููุฑูุฑ ุฃู ุงูุฌูุณุงุช

---

## ๐งฐ ุฃุฏูุงุช ุดููุฑุฉ ูุชุญููู ุงูุฐุงูุฑุฉ:

- **Volatility**
- **Redline**
- **Rekall**

---



<img width="1643" height="632" alt="image" src="https://github.com/user-attachments/assets/ee1eede0-ab64-4885-9296-fec1e31c350f" />


  
</details>







<details>
  <summary>Memory Dumps</summary>

# ๐ง Memory Dump in Forensics

## ๐งพ ูุง ูู ุงูู Memory Dumpุ

- ูู ููุทุฉ (Snapshot) ูุฐุงูุฑุฉ ุงูู RAM ูู ูุญุธุฉ ูุนููุฉ.
- ูุญุชูู ุนูู:
  - ุงูุนูููุงุช ุงูุฌุงุฑูุฉ
  - ุงูุฌูุณุงุช ุงููุดุทุฉ
  - ุงูุฃูุดุทุฉ ุงูุดุจููุฉ
  - ุฃุญูุงููุง: ูููุงุช ูุฑูุฑ ูููุงุชูุญ ูุดูุฑุฉ

> ๐ฏ ูุณุชุฎุฏู ูู ุงูุชุญููู ุงูุฌูุงุฆูุ ุงูุชุญูููุงุช ูู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉุ ูุนูููุงุช Threat Hunting.

---

## ๐ฏ ููุงุฐุง Memory Dump ูููุ

- ุฃุฏูุงุช ูุซู **Mimikatz** ุชุณุชุฎุฏูู ูุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงุนุชูุงุฏ (Credentials) ูู ุงูุฐุงูุฑุฉ.
- ูุณุงุนุฏ ุงููุญูููู ุนูู ููู **ูุง ุงูุฐู ูุงู ูุญุฏุซ** ุนูู ุงููุธุงู ูู ููุช ุงูุงูุชูุงุท.
- ูููู ููููุงุฌููู ุงุณุชุฎุฏุงู ุชูููุงุช ูุง ุชุชุฑู ุขุซุงุฑูุง ุนูู ุงููุฑุตุ ูุฐุง **RAM analysis ูู ุงูุฎูุงุฑ ุงููุญูุฏ** ูุฑุตุฏูู.

---

## ๐๏ธ ููููุฉ ุฅูุดุงุก Memory Dump

### ๐ช Windows:

- ุฃุฏูุงุช:
  - Crash Dumps (ุงูุชุฑุงุถููุง ูู `%SystemRoot%\MEMORY.DMP`)
  - Hibernation File (`hiberfil.sys`)
  - Sysinternals RAMMap
  - WinPmem, FTK Imager
- ูููู ุฃุฎุฐ Dump ูุงูู ุฃู ุนูููุฉ ูุญุฏุฏุฉ ููุท.

### ๐ง Linux & macOS:

- ุฃุฏูุงุช:
  - **LiME (Linux Memory Extractor)**
  - **dd** ูุน ุงููุตูู ุฅูู `/dev/mem` ุฃู `/proc/kcore`

> ๐ ุจุนุถ ุงูุฃูุธูุฉ ุชุชุทูุจ ุตูุงุญูุงุช ุนุงููุฉ ุฃู ุชุนุทูู ุงูุญูุงูุฉ ูููุตูู ุฅูู ูุฐู ุงููููุงุช.

---

## ๐งฐ ุฃููุงุน ุงูู Memory Dumps

| ุงูููุน               | ุงูุดุฑุญ                                                                          |
|---------------------|----------------------------------------------------------------------------------|
| Full Memory Dump    | ููุชูุท ูู ูุญุชููุงุช ุงูู RAM (User + Kernel)                                       |
| Process Dump        | ููุชูุท ุนูููุฉ ูุงุญุฏุฉ (ูููุฏ ูู ุงูููุฏุณุฉ ุงูุนูุณูุฉ)                                    |
| Pagefile/Swap       | ููุชูุท ุจูุงูุงุช ุชู ุชูุฑูุบูุง ุฅูู ุงููุฑุต (ูุซู `pagefile.sys` ูู Windows)              |
| Hibernation File    | ููุชูุท ูุญุชููุงุช RAM ูุญููุธุฉ ุนูุฏ ุฏุฎูู ุงูุฌูุงุฒ ูุถุน ุงูุฅุณุจุงุช (hiberfil.sys)              |

---

## โ๏ธ ุชุญุฏูุงุช ุงูุญุตูู ุนูู Memory Dump ูุธูู

ุงูููุงุฌููู ูุฏ ูุณุชุฎุฏููู ุชูููุงุช **Anti-Forensics** ูุซู:

### ๐ ุชูููุงุช ุงูุฅุฎูุงุก ูุงูุชุดููุด:

| ุงูุชูููุฉ                       | ุงููุตู                                                                 |
|-------------------------------|------------------------------------------------------------------------|
| Hidden Modules                | ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ ูู ูุงุฆูุฉ ุงูุนูููุงุช (Unlinked)                  |
| DKOM (Kernel Manipulation)    | ุชุนุฏูู ุจูุงูุงุช ุงูููุฑูู ูุฅุฎูุงุก ุงูุนูููุงุช ูุงูุณูุงูุงุช                        |
| Code Injection                | ุญูู ููุฏ ุฎุจูุซ ูู ุนูููุงุช ุดุฑุนูุฉ ูุซู `explorer.exe`                      |
| Memory Patching               | ุชุนุฏูู ูุญุชูู ุงูุฐุงูุฑุฉ ุฃู APIs ูุชุถููู ุฃุฏูุงุช ุงูุชุญููู                     |
| API Hooking                  | ุงุนุชุฑุงุถ ูุชุงุฆุฌ ุงูุฏูุงู ุงููููุฉ ูุซู `ReadProcessMemory`                     |
| Encrypted/Packed Payloads     | ุญููุงุช ูุดูุฑุฉ ุฃู ูุถุบูุทุฉ ูุชู ูููุง ููุท ุฃุซูุงุก ุงูุชูููุฐ                     |
| Trigger-based Execution       | ูุง ูุชู ุชุดุบูู ุงูููุฏ ุงูุฎุจูุซ ุฅูุง ุนูุฏ ุชุญูู ุดุฑูุท ูุนููุฉ                     |

> โ ูุฐู ุงูุฃุณุงููุจ ุชุชุทูุจ ุชุญููู ูุชูุฏู ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุซู: **memory carving**, **kernel-level inspection**, ู**behavior-based analysis**.

---

## ๐ก๏ธ ููุงุญุธุงุช ูููุฉ

- ุจุนุถ ุงูุฃุฏูุฉ ูุง ูููู ุงููุตูู ููุง ุฅูุง ูู RAM.
- Dump ูุธูู = ุฏููู ููู.
- ุฃุฏูุงุช ูุซู Volatility ูููููุง ูุดู ุงููุซูุฑ ูู ูุฐู ุงูุชูููุงุชุ ููููุง ุชุญุชุงุฌ ุฅูู ุชุญููู ูุชูุฏู.

---

ู



<img width="1705" height="735" alt="image" src="https://github.com/user-attachments/assets/9114cebc-2bc7-4044-9c2b-c2f34a13ef46" />


  
</details>





<details>
  <summary>Memory Analysis Attack Fingerprints</summary>



# ๐ง Memory-Based Threat Indicators in DFIR

ุชุญููู ุงูุฐุงูุฑุฉ (Memory Analysis) ุฃุฏุงุฉ ูููุฉ ูููุดู ุนู ุงูุชูุฏูุฏุงุช ุงูุชู ูุง ุชุชุฑู ุขุซุงุฑูุง ุนูู ุงููุฑุต. ููู ุชูุดู ุงูุฃูุดุทุฉ ุงูุชู ุชุญุฏุซ "ุงูุขู"ุ ููุง ูุฌุนููุง ูุซุงููุฉ ูุงูุชุดุงู ุงููุฌูุงุช ุงููุดุทุฉ ุฃู ุงูุฃุฎูุฑุฉ.

---

## ๐งฉ ุฃูู ุงูุขุซุงุฑ (Artifacts) ุงูุชู ูุชู ุงูุจุญุซ ุนููุง ูู ุงูุฐุงูุฑุฉ:

- ๐ธ **Processes ูุดุจููุฉ** ูุง ุชูุฌุฏ ููุง ูููุงุช ุนูู ุงููุฑุต.
- ๐ธ **DLL Injection**: ุญูู ููุฏ ุถุงุฑ ูู ุฐุงูุฑุฉ ุนูููุฉ ุดุฑุนูุฉ.
- ๐ธ **Process Hollowing**: ุงุณุชุจุฏุงู ุฐุงูุฑุฉ ุนูููุฉ ููุซููุฉ ุจููุฏ ุฎุจูุซ.
- ๐ธ **API Hooking**: ุงุนุชุฑุงุถ ูุงุณุชุจุฏุงู ุฏูุงู ุงููุธุงู ูุฅุฎูุงุก ุงูุณููู ุงูุฎุจูุซ.
- ๐ธ **Rootkits**: ุชุนูู ูู kernel space ูุชุฎูู ูููุงุช ุฃู ุงุชุตุงูุงุช ุฃู ุนูููุงุช.

> โณ๏ธ ุงูุฃุฏูุงุช ุงูุฌูุงุฆูุฉ ูููููุง ุงูุชุดุงู:
> - ููุงุทู ุฐุงูุฑุฉ ุบูุฑ ุงุนุชูุงุฏูุฉ
> - ุฑุคูุณ PE ุบูุฑ ูุชุทุงุจูุฉ
> - ุชูููุฐ ููุฏ ูู ุฐุงูุฑุฉ ูุงุจูุฉ ูููุชุงุจุฉ (Writable)

---

## ๐ฏ ุฃูุซูุฉ ููุฌูุงุช ูููู ูุดููุง ูู ุฎูุงู ุชุญููู ุงูุฐุงูุฑุฉ:

### ๐ T1003 - Credential Access

- ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงุนุชูุงุฏ (credentials) ูุจุงุดุฑุฉ ูู ุงูุฐุงูุฑุฉ.
- ุฃุฏูุงุช ูุซู **Mimikatz** ุชุจุฑุฒ ููุง.

---

### ๐ T1071 - Application Layer Protocol: C2

- **Malware ุจุฏูู ูููุงุช (Fileless)** ุชุชูุงุตู ูุน ุฎูุงุฏู ุชุญูู ุนุจุฑ HTTP/HTTPS/DNS.
- ูุฏ ูุฌุฏ:
  - **IP Addresses**
  - **Beacon Patterns**
  - **Decrypted Configs** ูู ุงูุฐุงูุฑุฉ ููุท.

---

### ๐ T1086 - In-Memory Script Execution

- PowerShell ุฃู Python ุชูุณุชุฎุฏู ูุชุดุบูู ุณูุฑูุจุชุงุช **ูุจุงุดุฑุฉ ูู RAM**.
- ุชุญููู ุงูุฐุงูุฑุฉ ูุฏ ููุดู:
  - ุณูุฑูุจุชุงุช ูุงููุฉ
  - ุฃูุงูุฑ ูุดูุฑุฉ (Encoded Commands)
  - ุณุฌูุงุช ูู ุนูููุฉ PowerShell

---

## ๐๏ธ ุชูููุงุช Persistence ูุงุจูุฉ ูููุดู ูู RAM

### โฐ T1053.005 - Scheduled Tasks

- ูุฑุงูุจุฉ ุนูููุงุช ูุซู `schtasks.exe`
- ูุญุต ุงูุฐุงูุฑุฉ ููุนุซูุฑ ุนูู ุฃุณูุงุก Tasks ุฃู ูุณุงุฑุงุช ุชูููุฐ ูุดุจููุฉ

---

### ๐งฑ T1543.003 - Malicious Windows Services

- ุงูุฎุฏูุงุช ูุฏ ุชุนูู ุฏุงุฎู `services.exe`
- ุชุญููู ุงูุฐุงูุฑุฉ ููููู ุงูุชุดุงู ุฃุณูุงุก ุบูุฑ ูุนุชุงุฏุฉ ุฃู ูููุงุช ุชูููุฐูุฉ ุถุงุฑุฉ

---

### ๐ช T1547.001 - Registry Run Keys

- ููุงุชูุญ ูุซู:

```
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
```


ูุชู ุงุณุชุฎุฏุงููุง ูุชุดุบูู malware ุนูุฏ ุจุฏุก ุงููุธุงู
- ูููู ุงูุนุซูุฑ ุนูููุง ุฏุงุฎู ุณุฌูุงุช Registry ุงููุญููุธุฉ ูุคูุชูุง ูู RAM

---

## ๐งญ Lateral Movement (ุญุฑูุฉ ุฌุงูุจูุฉ) ุนุจุฑ ุงูุฐุงูุฑุฉ

### ๐ T1021.002 - SMB / PsExec

- **PsExec** ูุณูุญ ุจุชูููุฐ ุฃูุงูุฑ ุนูู ุฃุฌูุฒุฉ ุฃุฎุฑู.
- ูุคุดุฑุงุช ูู ุงูุฐุงูุฑุฉ:
- ุฃุณูุงุก Services
- ุฃูุงูุฑ ุชูููุฐ ุนู ุจุนุฏ

---

### ๐ฅ๏ธ T1021.006 - WinRM Remoting

- ุฎุฏูุฉ `wsmprovhost.exe` ุชููุฐ PowerShell ุนุจุฑ ุงูุดุจูุฉ.
- ูุญุต ุงูุฐุงูุฑุฉ ูุฏ ููุดู ุนู ุชูุงุตูู ุฌูุณุงุช ุงูุชุญูู ุนู ุจูุนุฏ.

---

### ๐ป T1059.001 - Remote PowerShell Execution

- ุบุงูุจูุง ูุง ุชูุณุชุฎุฏู PowerShell ูุฃูุงูุฑ ุนู ุจุนุฏ.
- ุงูููุงุฌููู ูุณุชุฎุฏููู ุฃูุงูุฑ ูุดูุฑุฉ ุจู Base64 ุฃู ูุดูุดุฉ (Obfuscated)

---

### ๐งพ T1047 - WMI Execution

- ุฃูุงูุฑ ูุซู:


```
wmic process call create
```

ุชูุณุชุฎุฏู ูุฅูุดุงุก ุนูููุงุช ุนู ุจูุนุฏ.
- ูููู ุฃู ูุฌุฏูุง ูุณูุงุณู ุฃู Class References ูู ุงูุฐุงูุฑุฉ.

---

## โ ููุงุฐุง ูุนุชุจุฑ ุชุญููู ุงูุฐุงูุฑุฉ ูููุ

- ููุดู ุฃูุดุทุฉ ุบูุฑ ูุฑุฆูุฉ ูู ุงููุฑุต.
- ูุณุงุนุฏ ูู ุงูุชุญูููุงุช ุงูุญูุฉ (Live Forensics).
- ุถุฑูุฑู ูู ุญุงูุฉ ุงูุจุฑูุฌูุงุช ุจุฏูู ูููุงุช (Fileless Malware).

---



<img width="1652" height="716" alt="image" src="https://github.com/user-attachments/assets/3ed2e3ef-ba9b-4d96-aa75-423d54adccc3" />



  
</details>









<details>
  <summary>Practical</summary>

<img width="933" height="826" alt="image" src="https://github.com/user-attachments/assets/0b89af65-3d82-428f-a5bd-915ab59d336d" />


```
THM{m3mory_analyst_g00d_job}
```

  
</details>





















