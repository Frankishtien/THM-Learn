# Network Services

<details>
  <summary>SMB</summary>

<details>
    <summary>Understanding</summary>

🔹 **إيه هو SMB؟**

SMB (Server Message Block) هو بروتوكول بيخلّي الأجهزة على الشبكة تشارك حاجات زي:

* ملفات
* طابعات
* بورتات COM (اللي هي serial ports)
* خدمات تانية زي APIs

🔹 **شغال إزاي؟ (ببساطة)**

الكلينت (الجهاز اللي عايز يوصل لحاجة) يتصل بالسيرفر باستخدام الشبكة (TCP/IP).

* السيرفر بيرد عليه.
* الكلينت يبدأ يبعته أوامر (اسمها SMB commands) زي:

  * افتح الملف ده
  * اكتب في الملف ده
  * اقرأ من الملف ده
  * اطبع على الطابعة دي

👉 كل ده بيحصل عن بُعد كأنك شغال على الملف في جهازك.

🔹 **بيشتغل على إيه؟**

* موجود في Windows من أيام Windows 95.
* وفي أنظمة Linux/Unix بيستخدموا Samba علشان يشتغلوا مع SMB.

🔹 **أمثلة استخدام:**

* تشارك مجلد بين جهازين على شبكة محلية.
* الطابعة في الشركة متوصلة بجهاز سيرفر، وباقي الموظفين بيطبعوا عليها من أجهزتهم.
* الهاكرز بيستخدموا SMB في الهجمات (زي SMB enumeration عشان يشوفوا الملفات أو المستخدمين المشاركين في الشبكة).

💡 **معلومة مهمة:**

SMB له إصدارات، وSMBv1 قديم وضعيف أمنيًا، وبيُفضل استخدام SMBv2 أو SMBv3.

  
</details>
---
<details>
    <summary>Enumerating</summary>


# Canvas 🔍 المرحلة الأولى: Enumeration - الاستكشاف

### يعني إيه Enumeration؟
هو ببساطة جمع معلومات عن الهدف قبل ما تبدأ أي هجوم.

بتدور على:

- يوزرنيمات
- كلمات سر
- أسماء أجهزة
- مشاركة ملفات (SMB shares)
- بيانات أنظمة أو خدمات شغالة

### ليه مهم؟
عشان متضيعش وقتك على هجمات عشوائية ممكن تفشل أو تكسر السيرفر.

---

## 📁 SMB - Server Message Block
SMB = خدمة على الشبكة بتخلي الأجهزة تتشارك ملفات وطابعات.

في الـ CTF، غالبًا تلاقي:

- فولدرات مشتركة بدون باسوورد
- بيانات حساسة (كلمات سر، سكريبتات، باك أب)
- ملفات فيها تلميحات للتصعيد (Privilege Escalation)

---

## 🔎 Port Scanning - مسح البورتات
أول خطوة قبل ما تعمل أي حاجة:
تشوف الجهاز ده فاتح بورتات إيه.

### الأداة الأشهر: nmap
مثال:

```bash
nmap -sC -sV -p- TARGET_IP
```

- `-sC`: سكريبتات افتراضية (زي الفحص العادي)
- `-sV`: يجيب إصدار كل خدمة
- `-p-`: يفحص كل البورتات من 1 لـ 65535

---

## ⚒️ Enum4Linux - أداة استكشاف SMB
### إيه هي؟
أداة بتجمع معلومات من SMB زي:

- يوزرز
- فولدرات مشاركة
- جروبات
- سياسات الباسوورد

### طريقة الاستخدام:
```bash
enum4linux [options] TARGET_IP
```

### أهم التاجات:
| TAG | الوظيفة |
| --- | ------- |
| `-U` | يجيب لستة اليوزرز |
| `-M` | يجيب لستة الأجهزة |
| `-N` | يجيب أسماء بشكل مختلف |
| `-S` | يجيب الفولدرات المشاركة |
| `-P` | يجيب معلومات عن سياسة الباسوورد |
| `-G` | يجيب الجروبات والميمبرز |
| `-a` | يعمل كل دول مرة واحدة (اللي هو Full Scan) |

### مثال عملي:
```bash
enum4linux -a 10.10.10.10
```

هيطبعلك معلومات كأنك فتحت السيرفر من جوّه 🔍

---

## 🔥 نصيحة عمّ الدنيا:
بعد ما تلاقي SMB share:

- جرّب توصل بيها باستخدام `smbclient`
- استعرض الملفات
- دور على كلمات سر أو سكريبتات أو "أسرار مفضوحة"


</details>
---
<details>
    <summary>Exploiting</summary>

## 🧨 أنواع استغلال SMB (SMB Exploit Types)

### ✅ حاجتين رئيسيين ممكن تعتمد عليهم:

#### 1. ثغرات حقيقية (مثل RCE - Remote Code Execution)

زي: `CVE-2017-7494`

* ممكن تخلّي الهاكر يشغّل كود عن بُعد على السيرفر مباشرة.

#### 2. أخطاء إعدادات (Misconfigurations) ← ودي الأكتر شيوعًا!

زي مثلًا: مشاركة ملفات بدون باسوورد (Anonymous access)

* وده اللي بنشتغل عليه دلوقتي... 👇

---

## 📂 إزاي بنستغل SMB Misconfiguration؟

### من مرحلة الـ Enumeration عرفنا:

* اسم الشير (مثلاً: `public`, `backups`, `share`)
* عنوان السيرفر (IP)

ودي معلومات كافية نبدأ بيها دخول للـ share.

---

## 🧰 أداة SMBClient

### إيه SMBClient؟

أداة من أدوات الـ Samba package.

* تقدر بيها تتصل بسيرفر فيه SMB share وتستعرض الملفات كأنك فاتح Windows Explorer.

### 🔧 طريقة الاستخدام:

#### ✅ الصيغة العامة:

```bash
smbclient //IP/SHARE
```

#### 💡 ممكن تضيف شوية حاجات كده:

| الوسم     | معناه                                     |
| --------- | ----------------------------------------- |
| `-U name` | تحدد اسم المستخدم ("guest" أو تسيبه فاضي) |
| `-p port` | تحدد البورت (افتراضي 445)                 |

### ✅ مثال عملي:

لو السيرفر IP بتاعه `10.10.10.10` والـ share اسمه `public` ممكن تدخل كده:

```bash
smbclient //10.10.10.10/public -N
```

🔸 `-N` معناها "ما تستخدمش باسوورد" (يعني anonymous login)

---

## 📁 بعد ما تدخل:

هيظهرلك سطر تفاعلي (شبيه بالـ FTP)

### تقدر تستخدم أوامر زي:

* `ls` ← يعرض الملفات
* `cd folder_name` ← تدخل فولدر
* `get filename` ← تحمّل ملف
* `put filename` ← ترفع ملف (لو عندك صلاحية)

---

## 🎯 الزتونة:

لو لقيت Share مفتوح بدون باسوورد:

* استعرض الملفات
* نزل أي حاجة شكلها مشبوه (`backup`, `config`, `.txt`)
* دور على كلمات سر، يوزرات، سكريبتات
* ممكن تلاقي حاجة توصلك لـ Shell أو Access عالي


</details>

</details>

------------------------------------------------------------------------------------------------------------------------------------

<details>
  <summary>Telnet</summary>

<details>
    <summary>Understanding</summary>

## 🎯 ما هو Telnet؟

Telnet هو بروتوكول (يعني طريقة للتواصل بين جهازين) بيخلّيك تدخل على جهاز تاني عن بُعد وتنفذ عليه أوامر كأنك قاعد عليه بنفسك.

* يعني بتفتح "ترمينال" على جهازك، وتبدأ تكتب أوامر تشتغل على جهاز تاني، من غير ما تكون قدامه.

---

## ⚙️ إزاي Telnet بيشتغل؟

بتكتب أمر telnet في التيرمنال بالشكل ده:

```bash
telnet [IP] [PORT]
```

### مثال:

```bash
telnet 192.168.1.10 23
```

لو السيرفر اللي هناك مشغّل Telnet Server، هيفتح لك جلسة تيرمنال افتراضية (Virtual Terminal).

* تقدر بعدها تكتب أوامر وتتحكم في الجهاز اللي هناك.

---

## 🔐 هل Telnet آمن؟

للأسف لأ، ودي أهم نقطة:

* كل حاجة بتتبعت من خلال Telnet بتكون واضحة (Clear Text)، حتى الباسورد.
* أي حد في النص ممكن يتجسس ويشوف اللي انت بتكتبه (زي هجوم Man-in-the-middle).

✅ علشان كده، SSH (Secure Shell) جه كبديل أكثر أماناً، لأنه بيشفر الاتصال.

---

## ✅ تلخيص سريع:

| Telnet             | SSH                    |
| ------------------ | ---------------------- |
| غير مشفر           | مشفر بالكامل           |
| قديم وضعيف أمانياً | أكثر أمانًا واستخدامًا |
| بيشتغل على بورت 23 | بيشتغل على بورت 22     |


  
</details>
---
<details>
    <summary>Enumerating (not important)</summary>

## 🚀 Let's Get Started

قبل ما تبدأ أي مهمة اختراق أو تحليل أمني، لازم:

1. تشغل الجهاز الهدف (Target Machine) من المنصة (غالبًا TryHackMe).
2. تنتظر شوية لحد ما السيرفر يشتغل تمامًا — أحيانًا بياخد لحد 5 دقايق.

---

## 🔍 Enumeration – الاستكشاف

الـ Enumeration معناها "جمع المعلومات" عن الهدف، ودي خطوة أساسية جدًا قبل أي استغلال (Exploit).

* الفكرة إنك مش دايمًا هتلاقي الثغرات باينة كده على طول…
* ممكن تبقى ثغرة بسيطة جدًا بس مش واضحة غير لما تعمل فحص دقيق للـ network services.

---

## 📡 Port Scanning – فحص البورتات

دي أول خطوة دايمًا بنبدأ بيها علشان نعرف:

* إيه البورتات المفتوحة على الجهاز.
* إيه السيرفيس اللي شغالة (زي SSH, HTTP, FTP...).
* إصدار النظام (OS)، والإصدارات الخاصة بالخدمات (versions).

وده بيتم باستخدام أداة اسمها `nmap`.

### ✅ أمر nmap المستخدم عادة:

```bash
nmap -sC -sV -A -Pn <IP>
```

### 📌 شرح الأوامر:

| الأمر | المعنى                                     |
| ----- | ------------------------------------------ |
| -sC   | يشغل سكريبتات افتراضية للـ enumeration     |
| -sV   | يجيب إصدارات السيرفيس                      |
| -A    | يجيب معلومات متقدمة (OS, traceroute...)    |
| -Pn   | يتجاوز خطوة ping في حالة لو الـ ping متقفل |

### 💡 مثال عملي:

```bash
nmap -sC -sV -A -Pn 10.10.231.253
```

ده هيرجعلك كل البورتات المفتوحة ومين شغال عليها.

  
</details>
---
<details>
    <summary>Exploiting</summary>

## 🔥 أولًا: أنواع استغلال Telnet

### ✅ ليه Telnet بطبيعته غير آمن؟

* بيبعث البيانات بنص صريح (Plaintext) → أي حد يقدر يعترض الاتصال ويشوف الباسورد والبيانات.
* مفيش تشفير → عكس SSH.
* التحكم في الدخول ضعيف → ممكن حد يخش لو السيرفر معمول له misconfiguration.

---

## 🐞 طيب إيه أنواع الاستغلال؟

### 1. استغلال الثغرات (CVE):

* في ثغرات (CVE) معروفة في السيرفرات أو العملاء اللي بيشغلوا Telnet.
* تقدر تدور عليهم في المواقع دي:

  * 🔗 [https://www.cvedetails.com/](https://www.cvedetails.com/)
  * 🔗 [https://cve.mitre.org/](https://cve.mitre.org/)

مثال:

> ممكن تلاقي ثغرة في نسخة معينة من telnet بتسمح بعمل تنفيذ أوامر عن بعد بدون تسجيل دخول.

### 2. أسهل طريقة؟ استغلال Misconfiguration!

وده اللي دايمًا بنشوفه في CTFs أو بيئات ضعيفة:

* بورت telnet مفتوح بس مش ظاهر في الـ banners.
* باسورد ضعيف.
* أو حساب مستخدم مكشوف في مكان ما.

---

## 🧪 من مرحلة Enumeration عرفنا:

* في خدمة Telnet شغالة بشكل مخفي (ما ظهرتش في أول النظرة).
* الـ Service متسمية backdoor ← ممكن تكون متعمدة.
* في اسم مستخدم ظاهر: `Skidy`

⬅️ كل ده بيخلينا نشك إن في مدخل نقدر نستغله.

---

## 📲 إزاي ندخل على Telnet:

### ✅ أمر الاتصال:

```bash
telnet [ip] [port]
```

### مثال:

```bash
telnet 10.10.231.253 8012
```

---

## 🐚 إيه هو الـ Reverse Shell؟

### ✳️ تعريف "Shell":

هو ببساطة "واجهة تنفيذ أوامر"، زي الطرفية أو التيرمنال.

### ✳️ طب يعني إيه Reverse Shell؟

* العادي إنك أنت بتتصل بالجهاز الهدف.
* في الـ Reverse Shell، الجهاز الهدف هو اللي بيتصل بجهازك.

### خطوات:

1. جهازك يفتح بورت (Listening) باستخدام netcat:

```bash
nc -lvnp 4444
```

2. الجهاز الهدف لما يتنفذ عليه كود معين، بيرجعلك Shell.
3. ساعتها تتحكم فيه كأنه تيرمنال مفتوح قدامك.

---

## 🔧 أدوات تساعدك:

* أداة netcat (`nc`) → بتفتح بورت على جهازك وتستقبل الاتصال العكسي.

  
</details>

![image](https://github.com/user-attachments/assets/3e21ce51-add4-4699-92f8-78e5247f3ff7)

![image](https://github.com/user-attachments/assets/4f9b25ad-e78c-484b-86b0-3ea69422c88c)



</details>

---------------------------------------------------------------------------------------------------------------------------

<details>
  <summary>FTP</summary>

<details>
    <summary>Understanding</summary>

# ✅ ما هو FTP؟

**FTP (File Transfer Protocol)** هو بروتوكول يُستخدم لنقل الملفات بين جهازين عن طريق الشبكة (الإنترنت أو شبكة داخلية).  
هو بيشتغل بنظام **Client-Server**:

- **Client**: الجهاز اللي بيطلب الملف  
- **Server**: الجهاز اللي بيخزن الملفات وبيسمح بتحميلها أو رفعها

---

## ✅ إزاي FTP بيشتغل؟

الاتصال بيتم من خلال قناتين مختلفتين:

### 🔹 قناة الأوامر (Command/Control Channel):
- بتستخدم علشان إرسال الأوامر من العميل للسيرفر (زي "أرسل الملف ده" أو "هات الملف ده")
- السيرفر بيرد بردود الأوامر (زي "تم" أو "مفيش صلاحيات")

### 🔹 قناة البيانات (Data Channel):
- دي اللي بيتم فيها فعليًا نقل الملفات (تحميل أو رفع)

---

## ✅ أنواع الاتصال في FTP

### 🔹 Active Mode (الوضع النشط):
- الجهاز العميل (Client) هو اللي بيفتح Port وينتظر السيرفر يتصل بيه علشان يبعته البيانات
- يعني السيرفر بيبدأ الاتصال بالعميل في قناة البيانات

### 🔹 Passive Mode (الوضع السلبي):
- العكس، السيرفر هو اللي بيفتح Port وينتظر إن العميل يتصل بيه عليه
- الوضع ده بيتستخدم أكتر لما العميل ورا Firewall أو NAT

---

## ✅ ليه فيه قناتين؟

لو كان فيه قناة واحدة فقط، كنت لازم تستنى نقل الملف يخلص عشان تبعت أمر تاني.  
لكن بوجود قناتين:

- تقدر تبعت أوامر في أي وقت
- وتقدر تنقل بيانات بدون ما تعطل التحكم

---

## ✅ ملاحظات مهمة:

- **FTP غير مشفر**، وده معناه إن كل حاجة (حتى الباسورد) بتتبعت بنصها الصريح (Plaintext)، وده خطر
- علشان كده فيه بدائل زي:
  - **SFTP** (يعتمد على SSH ويوفر تشفير)
  - **FTPS** (نسخة مشفرة من FTP تعتمد على SSL/TLS)


</details>
---
<details>
    <summary>Enumerating</summary>


# ✅ ما هو FTP؟

**FTP (File Transfer Protocol)** هو بروتوكول يُستخدم لنقل الملفات بين جهازين عن طريق الشبكة (الإنترنت أو شبكة داخلية).  
هو بيشتغل بنظام **Client-Server**:

- **Client**: الجهاز اللي بيطلب الملف  
- **Server**: الجهاز اللي بيخزن الملفات وبيسمح بتحميلها أو رفعها

---

## ✅ إزاي FTP بيشتغل؟

الاتصال بيتم من خلال قناتين مختلفتين:

### 🔹 قناة الأوامر (Command/Control Channel):
- بتستخدم علشان إرسال الأوامر من العميل للسيرفر (زي "أرسل الملف ده" أو "هات الملف ده")
- السيرفر بيرد بردود الأوامر (زي "تم" أو "مفيش صلاحيات")

### 🔹 قناة البيانات (Data Channel):
- دي اللي بيتم فيها فعليًا نقل الملفات (تحميل أو رفع)

---

## ✅ أنواع الاتصال في FTP

### 🔹 Active Mode (الوضع النشط):
- الجهاز العميل (Client) هو اللي بيفتح Port وينتظر السيرفر يتصل بيه علشان يبعته البيانات
- يعني السيرفر بيبدأ الاتصال بالعميل في قناة البيانات

### 🔹 Passive Mode (الوضع السلبي):
- العكس، السيرفر هو اللي بيفتح Port وينتظر إن العميل يتصل بيه عليه
- الوضع ده بيتستخدم أكتر لما العميل ورا Firewall أو NAT

---

## ✅ ليه فيه قناتين؟

لو كان فيه قناة واحدة فقط، كنت لازم تستنى نقل الملف يخلص عشان تبعت أمر تاني.  
لكن بوجود قناتين:

- تقدر تبعت أوامر في أي وقت
- وتقدر تنقل بيانات بدون ما تعطل التحكم

---

## ✅ ملاحظات مهمة:

- **FTP غير مشفر**، وده معناه إن كل حاجة (حتى الباسورد) بتتبعت بنصها الصريح (Plaintext)، وده خطر
- علشان كده فيه بدائل زي:
  - **SFTP** (يعتمد على SSH ويوفر تشفير)
  - **FTPS** (نسخة مشفرة من FTP تعتمد على SSL/TLS)

---

# 🧠 الفكرة العامة

إحنا داخلين على غرفة CTF (تحدي) هدفها تعليمك إزاي تستغل FTP بشكل آمن.

---

# 🛠️ الخطوات اللي هنمشي عليها

## 1. ابدأ بنشر (Deploy) الماكينة
- لما تعمل Deploy للغرفة، استنى حوالي 5 دقايق لحد ما تشتغل.

---

## 2. الخطوة الأساسية دايمًا: Enumeration
يعني نبدأ نفحص الخدمات اللي شغالة على السيرفر.

- استخدم أداة **nmap** عشان تعمل Port Scan وتعرف إذا فيه FTP شغال:

```bash
nmap -sV -p 21 [IP Address]
```

---

## 3. احتمال يكون فيه Anonymous Login
يعني السيرفر يسمح لأي حد يدخل بدون Username أو Password.

- جرب كده:

```bash
ftp [IP Address]
```

- لما يطلب Username اكتب: `anonymous`  
- لما يطلب Password اضغط Enter بس

---

## 4. لو دخلنا، نبدأ نستعرض الملفات
استخدم الأوامر التالية:

- `ls` → لعرض الملفات  
- `get filename` → لتحميل ملف  
- `cd directory` → لدخول مجلد

---

## 5. ابحث عن أي ملف يحتوي على معلومات حساسة
- أحيانًا تلاقي ملف فيه Credentials أو Hints تساعدك تخترق باقي النظام

---

# 💡 معلومة مهمة

فيه نوع قديم من سيرفرات FTP بيكون فيه ثغرة تقدر تستغلها حتى **قبل تسجيل الدخول**، من خلال أمر `cwd` (تغيير المجلد).  
لو رد السيرفر بشكل مختلف على مجلدات حقيقية، تقدر تعرف أسماء المستخدمين.

- الثغرة موثقة هنا:  
🔗 [Exploit Link - Exploit-DB 20745](https://www.exploit-db.com/exploits/20745)


</details>
---
<details>
    <summary>Exploiting</summary>


# 📝 إيه هو FTP؟

**FTP (اختصار لـ File Transfer Protocol)** هو بروتوكول يستخدم لنقل الملفات بين جهازين عبر شبكة.

بيشتغل بنظام عميل - سيرفر، بمعنى إنك بتستخدم عميل FTP (اللي هو برنامج FTP زي FileZilla أو الأمر نفسه في الكونسول) علشان تتصل بـ سيرفر FTP وتقوم بنقل الملفات من أو إلى السيرفر ده.

---

## 🔓 ما هي الثغرات في FTP؟

### البيانات غير مشفرة:
- FTP بيوصل البيانات بشكل نص عادي، يعني لو حد بينفذ هجوم **Man-in-the-Middle (MIM)**، ممكن يلتقط كل المعلومات اللي بتتبادل على البروتوكول ده، زي كلمات المرور.

### كلمات مرور ضعيفة أو افتراضية:
- لو السيرفر FTP متهيئ بكلمات مرور ضعيفة أو افتراضية (مثال: admin:admin)، ممكن المهاجمين يستخدموا أدوات لتخمين الكلمات دي بسهولة.

---

# 🎯 إزاي نعمل هجوم على FTP؟

أول حاجة هنعملها هي محاولة تخمين كلمة المرور الخاصة بحساب على السيرفر.

هنستخدم أداة اسمها **Hydra** علشان نعمل **Brute Force** للهجوم، يعني هنجرب كلمات مرور كتير بسرعة كبيرة حتى نلاقي الكلمة الصحيحة.

---

# 🛠️ إزاي نستخدم أداة Hydra؟

Hydra هي أداة بتساعدنا في تخمين كلمات المرور على بروتوكولات كتير زي FTP، SSH، RDP وغيره.

### الأمر بتاع Hydra هيبقى كده:

```bash
hydra -t 4 -l dale -P /usr/share/wordlists/rockyou.txt -vV 10.10.10.6 ftp
```

### 💡 شرح الأمر بالتفصيل:

- **hydra**: ده اسم الأداة اللي هنستخدمها علشان نعمل الهجوم.
- **-t 4**: معناها إننا هنستخدم 4 اتصالات في نفس الوقت علشان نسرع الهجوم.
- **-l dale**: ده اسم المستخدم اللي هنهاجم عليه، في الحالة دي اسم المستخدم هو "dale".
- **-P /usr/share/wordlists/rockyou.txt**: ده مسار ملف قائمة كلمات المرور اللي هنستخدمها علشان نعمل Brute Force.  
  **rockyou.txt** هو ملف مشهور بيحتوي على كلمات مرور شائعة.
- **-vV**: ده بيخلي Hydra يعرض كل محاولة كلمة مرور في الكونسول علشان نشوف النتائج مباشرة.
- **10.10.10.6**: ده عنوان الـ IP الخاص بالجهاز الهدف اللي هننفذ عليه الهجوم.
- **ftp**: ده البروتوكول اللي هنستهدفه، في الحالة دي هو FTP.

---

# 🚀 الخطوات:

هنشغل أمر Hydra باستخدام التولز اللي شرحناها.

- **Hydra** هتبدأ تجرب كلمات المرور بشكل سريع. لو لقيت كلمة مرور صحيحة، هتدخل على السيرفر وده هيدينا إمكانية تصفح الملفات.

---

# 💥 إزاي نغتنم الفرصة؟

بعد ما **Hydra** تلاقي كلمة المرور، هنقدر ندخل على السيرفر ونشوف لو فيه ملفات مهمة أو نقاط ضعف تانية ممكن نستغلها للوصول لمزيد من الصلاحيات.


</details>

</details>
